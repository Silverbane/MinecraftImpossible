# This is where any shared scripts will live.
Scripts:
  Clear:
    Script:
    - '@CMDCON clearinventory <playername>'
    - '@CMDCON replaceitem entity <playername> slot.armor.head minecraft:leather_helmet'
    - '@CMDCON replaceitem entity <playername> slot.armor.chest minecraft:leather_chestplate'
    - '@CMDCON replaceitem entity <playername> slot.armor.legs minecraft:leather_leggings'
    - '@CMDCON replaceitem entity <playername> slot.armor.feet minecraft:leather_boots'
    - '@CMDCON replaceitem entity <playername> slot.hotbar.0 minecraft:stone_axe'
    - '@CMDCON xp -2147483647L <playername>'
    - '@CMDCON heal <playername>'
  PlayerLocY:
    Script:
    - '@SETINT $<playername>.CurrentYLoc <playerloc:y>'
  PlayerLoc2Y:
    Script:
    - '@SETINT $<playername>.CurrentYLoc2 <playerloc:y>'
  PopBuildingLoc:
    Script:
    - '@ADDINT $Building.ID 1'
    - '@SETINT $<playername>.BuildingID $Building.ID'
    - '@SETSTR $Building.<var:$<playername>.BuildingID>Loc <currentloc:<playername>>'
#    - '@PLAYER &8LOG Building $<playername>.BuildingID Location Set TO $Building.<var:$<playername>.BuildingID>Loc'
  TestDistanceCheck:
    Script:
    - '@SETSTR $<playername>.CurrentLocation <currentloc:<playername>>'
    - '@SETSTR $<playername>.DistanceStartLoc $<playername>.CurrentLocation'
    - '@SETINT $<playername>.DistanceCheckLimit 20'
    - '@SETINT $<playername>.DistanceCheckOOBTimeLimit 120'
    - '@CALL Shared:DistanceCheck'
    - '@IF b $<playername>.DistanceCheck = True'
    - ' @PLAYER Succesful call of distance check and you were in bounds.'
    - '@ELSE'
    - ' @PLAYER Distance check failed DistanceCheck $<playername>.DistanceCheck'
    - '@ENDIF'
  DistanceCheck:
# You will need the following to call this distance check script. First set the Start location that the distance will check from.
# Remember if you use $<playername>.CurrentLocation then set that before you call by doing this.
# Now set how far you would like to allow the distance from start to still pass distance check.
# Then call the script and if passed you will get a bool of $<playername>.DistanceCheck set to True.
#    - '@CMDOP vtrigger setloc <playername> CurrentLocation'
#    - '@SETSTR $<playername>.DistanceStartLoc <triggerloc> or <playerloc> or $<playername>.CurrentLocation'
#    - '@SETINT $<playername>.DistanceCheckLimit 20'
#    - '@CALL Shared:DistanceCheck'
#    - '@IF b $<playername>.DistanceCheck = True'
    Script:
    - '@DELVAR b $<playername>.DistanceCheck'
    - '@WHILE b $<playername>.DistanceCheck != True'
    - ' @PAUSE 2'
#    - ' @CMDOP vtrigger setloc <playername> CurrentLocation'
    - '  @SETSTR $<playername>.CurrentLocation <currentloc:<playername>>'
    - ' @SETINT $<playername>.DistanceTmp <distance:$<playername>.DistanceStartLoc:$<playername>.CurrentLocation>'
    - '     @IF i $<playername>.DistanceTmp <= $<playername>.DistanceCheckLimit'
    - '         @IF b <issneaking:> = True'
    - '             @SETBOOL $<playername>.DistanceCheck True'
    - '         @ENDIF'
    - '     @ELSE'
#    - ' @IF i $<playername>.DistanceTmp > $<playername>.DistanceCheckAmt'
    - '         @PLAYER You are to far away please move closer. Current Distance $<playername>.DistanceTmp of the allowed $<playername>.DistanceCheckLimit .
    Current time out of bounds $<playername>.DistanceCheckOOB out of the allowed $<playername>.DistanceCheckOOBTimeLimit'
    - '         @ADDINT $<playername>.DistanceCheckOOB 2'
    - '         @IF i $<playername>.DistanceCheckOOB >= $<playername>.DistanceCheckOOBTimeLimit'
    - '             @PLAYER You failed because you stayed out of bounds to long'
    - '             @SETBOOL $<playername>.DistanceCheck False'
    - '             @EXIT'
    - '         @ENDIF'
    - '     @ENDIF'
    - '@ENDWHILE'
  MenuSelection:
#Menu Selection is a work in progress.
    Script:
    # If not crouched and using hand then add 1 to selection array
    #
    - '@IF i <itemid> = 0'
    - '@AND b <issneaking:> = false'
    - ' @ADDINT $<playername>.MenuSelection 1'
    - ' @ADDSTR $<playername>.MenuSelectionStr $<playername>.MenuSelection'
    - ' @GETSTRLEN $<playername>.MenuSelectionCheck $<playername>.<var:$<playername>.MenuSelectionStr>'
        # If person is at the end of the valid values then go back to the first value which is 0                     
    - ' @IF i $<playername>.MenuSelectionCheck = 1'
    - '     @SETINT $<playername>.MenuSelection 0'
    - ' @ENDIF'    
    - ' @DELVAR i $<playername>.MenuSelectionCheck'
        # Set the Building selection
    - ' @SETSTR $<playername>.Building $Tech.<var:$<playername>.MenuSelection>'
    - ' @PLAYER Technology $Tech.<var:$<playername>.MenuSelection> Selected. Price: $<worldname>.Price<var:$<playername>.Building>Tech $Config.CurrencyType Click with Paper for description.'
    #  If crouched and using hand then subtract 1 from selection array
    # 
    - '@ELSE'
    - ' @IF i <itemid> = 0'
    - ' @AND b <issneaking:> = true'
    - '     @SUBINT $<playername>.MenuSelection 1'
            # If person is at the beginning of the valid values then go to the last value 
    - '     @GETSTRLEN $<playername>.MenuSelectionCheck $Tech.<var:$<playername>.MenuSelection>'        
    - '     @IF i $<playername>.MenuSelectionCheck = 1'
    - '         @ADDINT $<playername>.MenuSelection 1'
    - '        @GETSTRLEN $<playername>.MenuSelectionCheck $Tech.<var:$<playername>.MenuSelection>' 
    - '         @WHILE i $<playername>.MenuSelectionCheck != 1'
    - '             @ADDINT $<playername>.MenuSelection 1'
    - '             @GETSTRLEN $<playername>.MenuSelectionCheck $Tech.<var:$<playername>.MenuSelection>'
    - '         @ENDWHILE'
    - '         @SUBINT $<playername>.MenuSelection 1'
    - '     @ENDIF'
    - '     @DELVAR i $<playername>.MenuSelectionCheck'
            # Set the Building selection
    - '     @SETSTR $<playername>.Building $Tech.<var:$<playername>.MenuSelection>'
    - '     @PLAYER Technology $Tech.<var:$<playername>.MenuSelection> Selected. Price: $<worldname>.Price<var:$<playername>.Building>Tech $Config.CurrencyType Click with Paper for description.'
    - ' @ENDIF'
    - '@ENDIF'
  PriceCheck:
    Script:
    - '@SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '@SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - '@ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - '@IF i $ItemTypeAmount.<var:$<worldname>.<playername>PriceTemp> = 0'
    - ' @PLAYER No Items Needed'
    - ' @SETBOOL $<worldname>.<playername>PriceCheck true'
    - '@ELSE'
    - ' @LOOP $ItemTypeAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @ADDINT $<worldname>.<playername>PriceTempOnItemType 1'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>PriceTempOnItemType'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @SETSTR $<worldname>.<playername>PriceTempName $ItemName.<var:$<worldname>.<playername>PriceTemp>'
#    - ' @PLAYER $<worldname>.<playername>PriceTempName'
    - ' @SETSTR $<worldname>.<playername>PriceTempItemID $ITEMID.<var:$<worldname>.<playername>PriceTempName>'
    - ' @SETINT $<worldname>.<playername>PriceTempItemAmount $ItemAmount.<var:$<worldname>.<playername>PriceTemp>'
#    - ' @PLAYER Itemid $ITEMID.<var:$<worldname>.<playername>PriceTempName> amount $ItemAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @PLAYER $ItemAmount.<var:$<worldname>.<playername>PriceTemp> $ItemName.<var:$<worldname>.<playername>PriceTemp>'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - ' @ENDLOOP'
    - ' @SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '@ENDIF'
    - '@SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - '@ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - '@SETINT $<worldname>.<playername>PriceTempCurrency $<worldname>.Price<var:$<worldname>.<playername>PriceTemp>'
    - '@PLAYER $<worldname>.Price<var:$<worldname>.<playername>PriceTemp> $Config.CurrencyType'
    - '@SETINT $<worldname>.<playername>PriceTempOnItemType 0'
# This is the script that is called anytime there needs to be a price check.
# Example script that calls on price can be found in Tech.script.yml line 19 to 40'
  Price:
    Script:
    - '@SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '@SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - '@ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - '@IF i $ItemTypeAmount.<var:$<worldname>.<playername>PriceTemp> = 0'
    - ' @PLAYER No Items Needed'
    - ' @SETBOOL $<worldname>.<playername>PriceCheck true'
    - '@ELSE'
    - ' @LOOP $ItemTypeAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @ADDINT $<worldname>.<playername>PriceTempOnItemType 1'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>PriceTempOnItemType'
#    - ' @PLAYER $<worldname>.<playername>PriceTemp'
    - ' @SETSTR $<worldname>.<playername>PriceTempName $ItemName.<var:$<worldname>.<playername>PriceTemp>'
#    - ' @SETSTR $<worldname>.<playername>PriceTempRecipient $<worldname>.PriceRecipient<var:$<worldname>.<playername>PriceTemp>'
#    - ' @PLAYER $<worldname>.<playername>PriceTempName'
    - ' @SETSTR $<worldname>.<playername>PriceTempItemID $ITEMID.<var:$<worldname>.<playername>PriceTempName>'
    - ' @SETINT $<worldname>.<playername>PriceTempItemAmount $ItemAmount.<var:$<worldname>.<playername>PriceTemp>'
#    - ' @PLAYER Itemid $ITEMID.<var:$<worldname>.<playername>PriceTempName> amount $ItemAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @IF i <hasitem:<playername>:$<worldname>.<playername>PriceTempItemID> >= $<worldname>.<playername>PriceTempItemAmount'
    - '     @PLAYER You have $ItemAmount.<var:$<worldname>.<playername>PriceTemp> $ItemName.<var:$<worldname>.<playername>PriceTemp>'
    - '     @SETBOOL $<worldname>.<playername>PriceCheck true'
    - ' @ELSE'
    - '     @PLAYER You do not have the required Items. You are missing $ItemAmount.<var:$<worldname>.<playername>PriceTemp> $ItemName.<var:$<worldname>.<playername>PriceTemp>'
    - '     @SETBOOL $<worldname>.<playername>PriceCheck false'
    - '     @SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '     @BREAKLOOP'
    - ' @ENDIF'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - ' @ENDLOOP'
    - ' @SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '@ENDIF'
    - '@IF b $<worldname>.<playername>PriceCheck = true'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - ' @IF b $<worldname>.<playername>PriceSelectedBool = True'
    - '   @SETINT $<worldname>.<playername>PriceTempCurrency $<worldname>.<playername>PriceSelected'
    - ' @ELSE'
    - '   @SETINT $<worldname>.<playername>PriceTempCurrency $<worldname>.Price<var:$<worldname>.<playername>PriceTemp>'
    - ' @ENDIF'
    - ' @IF s $<worldname>.PriceRecipient<var:$<worldname>.<playername>PriceTemp> = Owner'
    - '     @IF b <givemoney:$<worldname>.<playername>BuildingOwner:$<worldname>.<playername>PriceTempCurrency> = true'
    - '     @AND b <takemoney:<playername>:$<worldname>.<playername>PriceTempCurrency> = true'
    - '         @PLAYER You give $<worldname>.<playername>BuildingOwner $<worldname>.Price<var:$<worldname>.<playername>PriceTemp> $Config.CurrencyType'
    - '         @ADDINT $<var:$<worldname>.<playername>BuildingOwner>.<var:$<worldname>.<playername>BuildingID>Profit $<worldname>.<playername>PriceTempCurrency'
    - '         @SETBOOL $<worldname>.<playername>PriceCheck true'
    - '     @ELSE'
    - '         @PLAYER You do not have enough money. You need $<worldname>.<playername>PriceTempCurrency $Config.CurrencyType'
    - '         @SETBOOL $<worldname>.<playername>PriceCheck false'
    - '     @ENDIF'
    - ' @ELSE'
    - '     @IF b <takemoney:<playername>:$<worldname>.<playername>PriceTempCurrency> = true'
#    - '     @AND b $<worldname>.<playername>PriceCheck != true'
    - '         @PLAYER You pay $<worldname>.<playername>PriceTempCurrency $Config.CurrencyType'
    - '         @SETBOOL $<worldname>.<playername>PriceCheck true'
    - '     @ELSE'
    - '         @PLAYER You do not have enough money. You need $<worldname>.<playername>PriceTempCurrency $Config.CurrencyType'
    - '         @SETBOOL $<worldname>.<playername>PriceCheck false'
    - '     @ENDIF'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF b $<worldname>.<playername>PriceCheck = true'
    - '@AND s $ItemTake.<var:$<worldname>.<playername>PriceTemp> = YES'
    - ' @LOOP $ItemTypeAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @ADDINT $<worldname>.<playername>PriceTempOnItemType 1'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>PriceTempOnItemType'
    - ' @SETSTR $<worldname>.<playername>PriceTempName $ItemName.<var:$<worldname>.<playername>PriceTemp>'
    - ' @SETSTR $<worldname>.<playername>PriceTempItemID $ITEMID.<var:$<worldname>.<playername>PriceTempName>'
    - ' @SETINT $<worldname>.<playername>PriceTempItemAmount $ItemAmount.<var:$<worldname>.<playername>PriceTemp>'
    - ' @IF b <takeitem:<playername>:$<worldname>.<playername>PriceTempItemID:$<worldname>.<playername>PriceTempItemAmount> = true'
    - '     @PLAYER You give $ItemAmount.<var:$<worldname>.<playername>PriceTemp> $ItemName.<var:$<worldname>.<playername>PriceTemp>'
    - '     @SETBOOL $<worldname>.<playername>PriceCheck true'
    - ' @ELSE'
    - '     @PLAYER IF YOU SEE THIS MESSAGE AN ERROR OCCURED. You may have lost some items please contact an admin ASAP with the following information: Failed on Step: $<worldname>.<playername>PriceTempOnItemType which is $ItemAmount.<var:$<worldname>.<playername>PriceTemp> $ItemName.<var:$<worldname>.<playername>PriceTemp> Building: $<worldname>.<playername>BuildingCategory Action: $<worldname>.<playername>Action'
    - '     @SETBOOL $<worldname>.<playername>PriceCheck false'
    - '     @SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '     @BREAKLOOP'
    - ' @ENDIF'
    - ' @SETSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>BuildingCategory'
    - ' @ADDSTR $<worldname>.<playername>PriceTemp $<worldname>.<playername>Action'
    - ' @ENDLOOP'
    - '@ENDIF'
    - '@SETINT $<worldname>.<playername>PriceTempOnItemType 0'
    - '@PLAYER Transaction Ended.'
  BlockCheckScript:
    Script:
#Check for Ender Portal Frame facing any direction  
    - '@IF b <isblocktype:<triggerloc>:120:0> = True'
    - '@OR b <isblocktype:<triggerloc>:120:1> = True'
    - '@OR b <isblocktype:<triggerloc>:120:2> = True'
    - '@OR b <isblocktype:<triggerloc>:120:3> = True'
    - ' @SETSTR $<playername>.BlockCheckScript Passed'
#    - ' @PLAYER Frame Passed'
    - '@ELSE'
    - ' @SETSTR $<playername>.BlockCheckScript Failed'
#    - ' @PLAYER Frame Failed'
    - '@ENDIF'
#Check for Ender Portal frame filled with eye    
    - '@IF b <isblocktype:<triggerloc>:120:5> = True'
    - '@OR b <isblocktype:<triggerloc>:120:6> = True'
    - '@OR b <isblocktype:<triggerloc>:120:7> = True'
    - '@OR b <isblocktype:<triggerloc>:120:8> = True'
    - ' @SETSTR $<playername>.BlockCheckActiveScript Passed'
#    - ' @PLAYER ActiveFrame Passed'
    - '@ELSE'
    - ' @SETSTR $<playername>.BlockCheckActiveScript Failed'
#    - ' @PLAYER ActiveFrame Failed'
    - '@ENDIF'
    - '@IF s $<playername>.BlockCheckScript != Passed'
    - '@AND s $<playername>.BlockCheckActiveScript != Passed'
    - ' @PLAYER This power was placed on an invalid block. All powers must be placed on an ender portal frame.'
    - '@ENDIF'
  CheckAirBlockDown:
    Script:
    - '         @DELVAR b $<playername>.BlockCheckDown'
    - '         @WHILE b $<playername>.BlockCheckDown = False'
    - '             @IF b <isblocktype:$<playername>.CurrentLocation:0:0> = True'
    - '                 @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,-1,0>'
    - '                 @PLAYER LOG Going Down $<playername>.CurrentLocation'
    - '             @ELSE'
    - '                 @IF b <isblocktype:$<playername>.CurrentLocation:35:4> = True'
    - '                 @OR b <isblocktype:$<playername>.CurrentLocation:35:14> = True'
    - '                    @PLAYER LOG Found wool $<playername>.CurrentLocation stop going down and do not go up.'
    - '                 @ELSE'
    - '                    @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,1,0>'
    - '                    @PLAYER LOG $<playername>.CurrentLocation stop going down and now go up 1 to last air block.'
    - '                 @ENDIF'
    - '                 @SETBOOL $<playername>.BlockCheckDown True'
    - '                 @PLAYER LOG Ending CheckAirBlockDown $<playername>.CurrentLocation'
    - '             @ENDIF'
    - '         @ENDWHILE'
    - '         @PLAYER LOG Ended CheckAirBlockDown and TownBorderStep set to $<playername>.TownBordersStep'
  CreateTownBorders:
    Script:
#    - '@CMDOP vtrigger setloc <playername> CurrentLocation'
    - '@SETSTR $<playername>.CurrentLocation $TownPlotLocations.<var:$<playername>.TMPStr>'
#    - '@SETBLOCK 35:4 $<playername>.CurrentLocation'
    - '@DELVAR i $<playername>.TownBordersStepSq'
    - '@DELVAR i $<playername>.TownBordersStep'
    - '@WHILE i $<playername>.TownBordersStepSq != 9'
#       This is here just to make if the script breaks we are not in a forever while loop
    - ' @ADDINT $<playername>.STOPWHILE 1'
    - ' @IF i $<playername>.STOPWHILE = 100'
#    - '     @PLAYER TownBorderStep While script bugged out needs to exit.'
    - '     @EXIT'
    - ' @ENDIF'
    - ' @DELVAR b $<playername>.BlockCheck'
    - ' @SETSTR $<playername>.CurrentLocationOrig $<playername>.CurrentLocation'
#       While to check to make sure wool is replacing an air block
    - ' @WHILE b $<playername>.BlockCheck = False'
#           This is here just to make if the script breaks we are not in a forever while loop
    - '     @ADDINT $<playername>.STOPWHILE2 1'
    - '     @IF i $<playername>.STOPWHILE2 = 300'
#    - '         @PLAYER AirCheck While script bugged out needs to exit.'
    - '         @EXIT'
    - '     @ENDIF'
#           Checking blocks if they are air or red wool or yellow wool.    
    - '     @IF b <isblocktype:$<playername>.CurrentLocation:0:0> = True'
    - '     @OR b <isblocktype:$<playername>.CurrentLocation:35:4> = True'
    - '     @OR b <isblocktype:$<playername>.CurrentLocation:35:14> = True'
    - '         @CALL Shared:CheckAirBlockDown'
# ADD IF we want to do more then 1 block of air going up is needed    - ' @AND b <isblocktype:$<playername>.CurrentLocation2:0:0> = True'
    - '         @SETBOOL $<playername>.BlockCheck True'
    - '         @ADDINT $<playername>.TownBordersStep 1'
    - '         @PLAYER LOG TownBorderStep set to $<playername>.TownBordersStep'
    - '     @ELSE'
    - '         @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,1,0>'
#    - '         @SUBINT $<playername>.LocTempY 1'
    - '         @PLAYER LOG Going Up $<playername>.CurrentLocation'
    - '     @ENDIF'
    - ' @ENDWHILE'
    - ' @DELVAR i $<playername>.STOPWHILE2'
#       Steps start here for creating borders of one town square.
    - ' @IF i $<playername>.TownBordersStep = 1'
    - '     @PLAYER LOG Step $<playername>.TownBordersStep Placing Yellow Wool at $<playername>.CurrentLocation'
    - '     @SETBLOCK 35:4 $<playername>.CurrentLocation'
    - '     @SETSTR $<playername>.CurrentLocation $<playername>.CurrentLocationOrig'
    - '     @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:15,0,0>'
#    - '     @DELVAR i $<playername>.LocTempY'
    - ' @ELSE'
    - '     @IF i $<playername>.TownBordersStep = 2'
    - '         @PLAYER LOG Step $<playername>.TownBordersStep Placing Red Wool at $<playername>.CurrentLocation'
    - '         @SETBLOCK 35:14 $<playername>.CurrentLocation'
    - '         @SETSTR $<playername>.CurrentLocation $<playername>.CurrentLocationOrig'
    - '         @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,0,-15>'
#    - '         @DELVAR i $<playername>.LocTempY'
    - '     @ELSE'
    - '         @IF i $<playername>.TownBordersStep = 3'
    - '             @PLAYER LOG Step $<playername>.TownBordersStep Placing Red Wool at $<playername>.CurrentLocation'
    - '             @SETBLOCK 35:14 $<playername>.CurrentLocation'
    - '             @SETSTR $<playername>.CurrentLocation $<playername>.CurrentLocationOrig'
    - '             @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:-15,0,0>'
#    - '             @DELVAR i $<playername>.LocTempY'
    - '         @ELSE'
    - '             @IF i $<playername>.TownBordersStep = 4'
    - '                 @PLAYER LOG Step $<playername>.TownBordersStep Placing Red Wool at $<playername>.CurrentLocation'
    - '                 @SETBLOCK 35:14 $<playername>.CurrentLocation'
    - '                 @SETSTR $<playername>.CurrentLocation $<playername>.CurrentLocationOrig'
    - '                 @ADDINT $<playername>.TownBordersStepSq 1'
    - '             @ENDIF'
    - '         @ENDIF'
    - '     @ENDIF'
    - ' @ENDIF'
#       Steps start here for when town borders for 1 square are done this moves it to the surrounding town squares to make the borders for those as well.
    - ' @IF i $<playername>.TownBordersStepSq = 1'
    - ' @AND i $<playername>.TownBordersStep = 4'
    - '     @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:-16,0,-1>'
#    - '     @DELVAR i $<playername>.LocTempY'
    - '     @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '     @DELVAR i $<playername>.TownBordersStep'
    - ' @ELSE'
    - '     @IF i $<playername>.TownBordersStepSq = 2'
    - '     @AND i $<playername>.TownBordersStep = 4'
#    - '         @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:15,0,16>'
    - '         @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:16,0,15>'
#    - '         @DELVAR i $<playername>.LocTempY'
    - '         @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '         @DELVAR i $<playername>.TownBordersStep'
    - '     @ELSE'
    - '         @IF i $<playername>.TownBordersStepSq = 3'
    - '         @AND i $<playername>.TownBordersStep = 4'
#    - '             @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:15,0,16>'
    - '             @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:16,0,15>'
#    - '             @DELVAR i $<playername>.LocTempY'
    - '             @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '             @DELVAR i $<playername>.TownBordersStep'
    - '         @ELSE'
    - '             @IF i $<playername>.TownBordersStepSq = 4'
    - '             @AND i $<playername>.TownBordersStep = 4'
    - '                 @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,0,31>'
#    - '                 @DELVAR i $<playername>.LocTempY'
    - '                 @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '                 @DELVAR i $<playername>.TownBordersStep'
    - '             @ELSE'
    - '                 @IF i $<playername>.TownBordersStepSq = 5'
    - '                 @AND i $<playername>.TownBordersStep = 4'
    - '                     @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,0,31>'
#    - '                     @DELVAR i $<playername>.LocTempY'
    - '                     @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '                     @DELVAR i $<playername>.TownBordersStep'
    - '                 @ELSE'
    - '                     @IF i $<playername>.TownBordersStepSq = 6'
    - '                     @AND i $<playername>.TownBordersStep = 4'
    - '                         @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:-16,0,15>'
#    - '                         @DELVAR i $<playername>.LocTempY'
    - '                         @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '                         @DELVAR i $<playername>.TownBordersStep'
    - '                     @ELSE'
    - '                         @IF i $<playername>.TownBordersStepSq = 7'
    - '                         @AND i $<playername>.TownBordersStep = 4'
    - '                             @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:-16,0,15>'
#    - '                             @DELVAR i $<playername>.LocTempY'
    - '                             @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '                             @DELVAR i $<playername>.TownBordersStep'
    - '                         @ELSE'
    - '                             @IF i $<playername>.TownBordersStepSq = 8'
    - '                             @AND i $<playername>.TownBordersStep = 4'
    - '                                 @SETSTR $<playername>.CurrentLocation <relativeloc:$<playername>.CurrentLocation:0,0,-1>'
#    - '                                 @DELVAR i $<playername>.LocTempY'
    - '                                 @PLAYER LOG Start Square $<playername>.TownBordersStepSq at $<playername>.CurrentLocation'
    - '                                 @DELVAR i $<playername>.TownBordersStep'
    - '                             @ENDIF'
    - '                         @ENDIF'
    - '                     @ENDIF'
    - '                 @ENDIF'
    - '             @ENDIF'
    - '         @ENDIF'
    - '     @ENDIF'
    - ' @ENDIF'
    - '@ENDWHILE'
    - '@DELVAR i $<playername>.STOPWHILE'
    - '@PLAYER Visual plot borders setup completed. All yellow dyed wool are the south west corners of each town block. The rest are red dyed wool to designate the other three corners.'
  CopyTownBlocks:
    Script:
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR b $<playername>.CopyCheckTmp'
    - '@WHILE b $<playername>.CopyCheckTmp != True'
    - ' @PAUSE 2'
    - ' @IF s <getblocklos:LOC:10> = $TownPlotLocations.<var:$<playername>.TMPStr>'
    - ' @AND s <getblocklos:TYPE:10> = 35:4'
    - '     @CMDOP /hpos1'
    - '     @CMDOP /hpos2'
    - '     @CMDOP /shift 1 down'
    - '     @CMDOP /expand 15 north'
    - '     @CMDOP /expand 15 east'
    - '     @CMDOP /expand vert'
    - '     @CMDOP /copy'
    - '     @ADDINT $<playername>.<var:$<playername>.CurrentBuildingTown>TownCopyUsed 1'
    - '     @SETBOOL $<playername>.CopyCheckTmp True'
    - '     @PLAYER Plot copied successfully'
    - ' @ELSE'
    - '     ADDINT $<playername>.WhileCheckTimeLimitTmp 2'
    - '     @PLAYER Copy Failed. KEEP TRYING. You must be looking at the yellow dyed wool that was created when you claimed this plot.'
    - '     @PLAYER LOG Current block looking at LOC <getblocklos:LOC:10> and ID <getblocklos:TYPE:10> block broke to purchase $TownPlotLocations.<var:$<playername>.TMPStr>'
    - ' @ENDIF'
    - ' @IF i $<playername>.WhileCheckTimeLimitTmp >= 300'
    - '     @PLAYER You took to long. Your time limit was 5 minutes. Contact an admin if you think this was due to bug or if you want to try to copy again.'
    - '     @EXIT'
    - ' @ENDIF'
    - '@ENDWHILE'
  BuildingID:
    Script:
#    - '@CMDCON pex user <playername> group remove Towny'
    - '@CALL Shared:FindCommandBlock'
    - '@IF s $<playername>.FoundCommandBlock = True'
#    - ' @PLAYER &8LOG CBlock Loc $<playername>.CommandBlockLoc'
    - ' @SETSTR $<worldname>.<playername>CoordsFixed $<playername>.CommandBlockLoc'
    - ' @CALL Shared:CleanCoordsID'
    - ' @SETSTR $<worldname>.<playername>BuildingID $<worldname>.<playername>CoordsFixed'
#    - ' @PLAYER &8LOG Fixed BuildingID $<worldname>.<playername>BuildingID'    
    - ' @SETSTR $<worldname>.<playername>CoordsFixed Deleted'
#    - '@PLAYER &8LOG Owner Lookup $<worldname>.<var:$<worldname>.<playername>BuildingID>Owner'
    - ' @SETSTR $<worldname>.<playername>BuildingCategory $<worldname>.<var:$<worldname>.<playername>BuildingID>Category'
    - ' @SETSTR $<worldname>.<playername>BuildingTown $<worldname>.<var:$<worldname>.<playername>BuildingID>Town'
    - ' @SETSTR $<worldname>.<playername>BuildingOwner $<worldname>.<var:$<worldname>.<playername>BuildingID>Owner'
    - ' @SETSTR $<worldname>.<playername>BuildingSchematic $<worldname>.<var:$<worldname>.<playername>BuildingID>Schematic'
    - ' @SETINT $<worldname>.<playername>BuildingLevel $<worldname>.<var:$<worldname>.<playername>BuildingID>Level'
    - ' @SETSTR $<worldname>.<playername>BuildingDirection $<worldname>.<var:$<worldname>.<playername>BuildingID>Direction'    
    # Find out if building is not owned
    - ' @GETSTRLEN $<worldname>.<playername>BuildingOwnerStrlen $<worldname>.<playername>BuildingOwner'
    - ' @IF i $<worldname>.<playername>BuildingOwnerStrlen >= 2'
    - '   @SETBOOL $<worldname>.<playername>NoOwner False'
    - ' @ELSE'
    - '   @SETBOOL $<worldname>.<playername>NoOwner True'
    - ' @ENDIF'
#    - '@PLAYER &8LOG Building ID set to $<worldname>.<playername>BuildingID Owner Set $<worldname>.<playername>BuildingOwner'
#    - ' @SOUNDEX FIRE_IGNITE 1.0 1.0 <triggerloc>'
#    - ' @PAUSE 1'
#    - ' @SOUNDEX FIRE 1.0 1.0 <triggerloc>'
#    - ' @FLAMES 3 <triggerloc>'
#    - '@PLAYER &8LOG BuildingOwner $<worldname>.<playername>BuildingOwner PersonClickingTeam <var:$<playername>.SMTeam>'
    - ' @IF s $<worldname>.<playername>BuildingOwner = <var:$<playername>.SMTeam>'
    - '   @SETBOOL $<worldname>.<playername>AllowedUse True'
    - ' @ELSE'
    - '   @SETBOOL $<worldname>.<playername>AllowedUse False'
#    - '@PLAYER &8LOG AllowedUse $<worldname>.<playername>AllowedUse'
    - ' @ENDIF'
#    - '@PLAYER &8LOG Category $<worldname>.<playername>BuildingCategory'
#    - '@PLAYER &8LOG Town $<worldname>.<playername>BuildingTown'
#    - '@PLAYER &8LOG Owner $<worldname>.<playername>BuildingOwner'
#    - '@PLAYER &8LOG Name $<worldname>.<playername>BuildingName'
#    - ' @IF i <itemid> = 339'
#    - '     @CALL <var:$<worldname>.<playername>BuildingCategory>:Help'
#    - ' @ENDIF'
    - ' @IF i <itemid> = 386'
    - '     @IF b $<worldname>.<playername>AllowedUse = True'
    - '         @PLAYER You open the building ledger.'
    - '         @PLAYER Upkeep: $Ledger.<var:$<worldname>.<playername>BuildingID>Upkeep'
    - '         @IF s $<worldname>.<playername>BuildingCategory = ConstructionYard'
    - '             @PLAYER Profit: $<worldname>.<playername>SchematicsProfit'
    - '         @ELSE'
    - '             @PLAYER Profit: $<worldname>.<playername><var:$<worldname>.<playername>BuildingID>Profit'
    - '         @ENDIF'
#    - '     @PLAYER Population: $Ledger.<var:$<worldname>.<playername>BuildingID>Pop'
    - '         @PLAYER &4PRICE:&r Upkeep:'
    - '         @SETSTR $<worldname>.<playername>Building $<worldname>.<playername>BuildingCategory'
    - '         @SETSTR $<worldname>.<playername>Action Upkeep'
    - '         @CALL Shared:PriceCheck'
    - '     @ENDIF'
    - ' @ENDIF'
    - ' @IF b $<worldname>.<playername>AllowedUse = True'
    - '   @IF s $<worldname>.<playername>BuildingCategory = Fletcher'
    - '     @SETINT $<worldname>.<var:$<playername>.SMTeam>FletcherLevel $<worldname>.<playername>BuildingLevel'
    - '   @ENDIF'
    - '   @CLOSEINV <playername>'
    - '   @CMDCON title <playername> title {text:"Opening $<worldname>.<playername>BuildingCategory Menu",color:yellow}'
    - '   @PLAYER Opening $<worldname>.<playername>BuildingCategory Menu'
    - ' 	@PAUSE 1'
    - '   @OPENINV $<worldname>.<playername>BuildingCategory'
    - '   @EXIT'
    - ' @ENDIF'
    - ' @IF b $<worldname>.<playername>NoOwner = True'
    - ' @AND b $<worldname>.<var:$<playername>.SMTeam>Building != True'
    - ' @AND b $<worldname>.<var:$<playername>.SMTeam>ActivateCB = True'
#    - '@PLAYER &8LOG No Owner Calling <var:$<worldname>.<playername>ActivePlans>:Ledger'
    - '   @CALL <var:$<worldname>.<playername>ActivePlans>:Ledger'
    - ' @ENDIF'
    - '@ENDIF'
  Upkeep:
    Script:
    - '@IF s $<playername>.BlockCheckScript = Passed'
    - '@OR s $<playername>.BlockCheckActiveScript = Passed'
    - ' @IF i <itemid> = 296'
    - ' @AND s $<playername>.CurrentBuildingOwner = <playername>'
    - '     @PLAYER Current Upkeep level: $Ledger.<var:$<playername>.CurrentBuildingID>Upkeep'
    - '     @SETSTR $<playername>.Building $<playername>.CurrentBuildingCategory'
    - '     @SETSTR $<playername>.Action Upkeep'
    - '     @CALL Shared:Price'
    - '     @IF b $<playername>.PriceCheck = true'
# Maybe store this in NateConfig to allow people to have it add more then 1 use per upkeep grab.    
    - '         @ADDINT $Ledger.<var:$<playername>.CurrentBuildingID>Upkeep 1'
    - '         @LIGHTNING false <triggerloc>'
    - '         @PLAYER Added 1 use to upkeep level. Current level is now $Ledger.<var:$<playername>.CurrentBuildingID>Upkeep .'
    - '     @ENDIF'
    - ' @ENDIF'
    - ' @IF i $Ledger.<var:$<playername>.CurrentBuildingID>Upkeep < 1'
    - '     @SETBLOCK 120:0 <triggerloc>'
    - '     @PLAYER This buildings powers fail as the upkeep has been depleted. You must wait for $<playername>.CurrentBuildingOwner to add more upkeep by selecting this block while having wheat equipped.'
    - '     @CMDOP mail send $<playername>.CurrentBuildingOwner Your $<playername>.CurrentBuildingCategory named $<playername>.CurrentBuildingName in the town of $<playername>.CurrentBuildingTown has run out of upkeep. <playername> was the last person to try to use it.'
    - ' @ENDIF'
    - ' @IF i $Ledger.<var:$<playername>.CurrentBuildingID>Upkeep >= 1'
    - '     @SETBLOCK 120:5 <triggerloc>'
    - ' @ENDIF'
    - ' @CALL Shared:BlockCheckScript'
    - '@ENDIF'
# FINISHED! Needs last test where it actrually runs from an outside script.
#  PlaceScript:
#    Script:
#    - '@PLAYER Wounded_Fighter is a dumbass'
  PlaceScript:
    Script:
# This is needed in order to call PlaceScript.    
#    - '@SETSTR $<playername>.PlaceScriptTMP vtclick @SETSTR $Placeholder.SchematicToBuy <var:$<playername>.PublishSchematic>'    
#    - '@CALL Shared:PlaceScript'
#    - '@DELVAR s $<playername>.PlaceScriptTMP'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '@DELVAR b $<playername>.LOSCheckTmp'
    - '@DELVAR s $<playername>.LOSLocTmp'
    - '@DELVAR s $<playername>.BlockTypeTMP'
    - '@EXPLOSION 0.0 <currentloc:<playername>>'
    - '@FLAMES 3 <currentloc:<playername>>'
    - '@POOF 3 <currentloc:<playername>>' 
#    - '@DROPITEM EYE_OF_ENDER 1 NONE <currentloc:<playername>>'
    - '@IF i <giveitem:<playername>:381:1> = 1'
    - ' @PLAYER &4An Enchanted Eye of Ender appears in your inventory.&r'
    - '@ENDIF'
    - '@WHILE i <hasitem:<playername>:381> = 0'
    - ' @IF i <hasitem:<playername>:381> = 0'
#    - '     @PLAYER &4An Enchanted Eye of Ender appears on the ground next to you. Pick it up.&r'
    - '     @PLAYER &4Your Inventory is full please make room.'
    - ' @ENDIF'
    - ' @PAUSE 5'
    - ' @ADDINT $<playername>.WhileCheckTimeLimitTmp 5'
    - ' @IF i $<playername>.WhileCheckTimeLimitTmp >= 300'
    - '     @PLAYER &4You took to long.&r Your time limit was 5 minutes. Contact an admin if you think this was due to bug or if you want to try to place the script again.'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '     @EXIT'
    - ' @ENDIF'
    - '@ENDWHILE'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@PLAYER Now &4look at&r the empty ender portal frame while having the &4An Enchanted Eye of Ender&r in your hands and slowly walk up to it and right click on it.'
    - '@WHILE b $<playername>.LOSCheckTmp != True'
    - ' @ADDINT $<playername>.WhileCheckTimeLimitTmp 1'
#    - ' @PLAYER &8LOG Current Item Holding <itemid> &r'
# New Wand item Eye of Ender 381 Check.
#    - ' @IF i <itemid> = 381'
    # Check if looking at end portal frame without an eye.
#    - '     @PLAYER &8LOG Current Block Looking at within 3 sqrs <getblocklos:TYPE:3> &r'
    - '     @IF s <getblocklos:TYPE:3> = 120:0'
    - '     @OR s <getblocklos:TYPE:3> = 120:1'
    - '     @OR s <getblocklos:TYPE:3> = 120:2'
    - '     @OR s <getblocklos:TYPE:3> = 120:3'
#    - '         @LIGHTNING false <playerloc>'
    - '         @SOUNDEX ENDERMAN_STARE 1.0 2.0 <currentloc:<playername>>'
    - '         @CMDCON freeze <playername>'
            #Place script you want them to be able to place right here.
    - '         @IF s $<playername>.PlaceScriptType = MonsterEvent'
    - '             @CMDOP vtclick @SETSTR $Placeholder.MonsterEvent $<playername>.MonsterEventID'
    - '         @ELSE'
    - '             @CMDOP $<playername>.PlaceScriptTMP'
    - '         @ENDIF'
    - '         @PLAYER The &4Eye of Ender&r is now ready to be &4joined&r with the &4empty end portal frame&r. In order for it to by joined correctly you must &4DOUBLE RIGHT CLICK&r with the eye on the portal frame.'
    - '         @SETBOOL $<playername>.LOSCheckTmp True'
    - '     @ELSE'
    - '         @IF i $<playername>.WhileCheckTimeLimitTmp >= 150'
#    - '             @CMDOP vtclickview'
    - '             @SETINT $<playername>.WhileCheckTimeLimitTmp 0'
    - '             @ADDINT $<playername>.WhileCheckTimeLimitTotalTmp 150'
    - '             @PLAYER You must be &4looking&r at an &4end portal frame&r that is not filled in with an &4eye&r while being at most &4 3 squares away&r.'
    - '             @PLAYER &8Log Current block looking at LOC <getblocklos:LOC:100> and ID <getblocklos:TYPE:100> &r'
    - '         @ENDIF'
    - '     @ENDIF'
    - '     @IF i $<playername>.WhileCheckTimeLimitTotalTmp >= 1500'
    - '     @AND b $<playername>.LOSCheckTmp != True'
    - '         @PLAYER &4You took to long.&r Your time limit was 5 minutes. Contact an admin if you think this was due to bug or if you want to try to place the script again.'
    - '         @DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '         @DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '         @EXIT'
    - '     @ENDIF'
#    - ' @ENDIF'
    - ' @SETSTR $<playername>.BlockTypeTMP <getblocklos:TYPE:3>'
    - ' @PAUSE 0.2'
    - '@ENDWHILE'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '@DELVAR b $<playername>.LOSCheckTmp'
    - '@WHILE b $<playername>.LOSCheckTmp != True'
    - ' @ADDINT $<playername>.WhileCheckTimeLimitTmp 1'
        # Make sure end portal frame now has an eye from player placing script.
    - ' @IF s <getblocklos:TYPE:3> = 120:4'
    - ' @OR s <getblocklos:TYPE:3> = 120:5'
    - ' @OR s <getblocklos:TYPE:3> = 120:6'
    - ' @OR s <getblocklos:TYPE:3> = 120:7'
    - ' @OR s <getblocklos:TYPE:3> = 120:8'
    - ' @OR s $<playername>.BlockTypeTMP = 120:4'
    - ' @OR s $<playername>.BlockTypeTMP = 120:5'
    - ' @OR s $<playername>.BlockTypeTMP = 120:6'
    - ' @OR s $<playername>.BlockTypeTMP = 120:7'
    - ' @OR s $<playername>.BlockTypeTMP = 120:8'
    - '     @SETSTR $<playername>.LOSLocTmp <getblocklos:LOC:3>'
#    - '     @PAUSE 2'
    - '     @SETBOOL $<playername>.LOSCheckTmp True'
    - '     @LIGHTNING false $<playername>.LOSLocTmp'
    - '     @SETBLOCK 120:0 $<playername>.LOSLocTmp'
    - '     @PLAYER &4The ender portal frame consumes the eye and gains power.&r'
    - '     @CMDCON freeze <playername>'
    - '     @EXIT'
    - ' @ELSE'
    - '     @IF i $<playername>.WhileCheckTimeLimitTmp >= 150'
    - '         @SETINT $<playername>.WhileCheckTimeLimitTmp 0'
    - '         @ADDINT $<playername>.WhileCheckTimeLimitTotalTmp 150'
    - '         @PLAYER &4DOUBLE Right Click on the Ender Portal Frame with the Eye of Ender&r'
    - '         @PLAYER &8Log Current block looking at LOC <getblocklos:LOC:100> and ID <getblocklos:TYPE:100> &r'
    - '     @ENDIF'
    - '     @IF s <getblocklos:TYPE:3> != 120:0'
    - '     @AND s <getblocklos:TYPE:3> != 120:1'
    - '     @AND s <getblocklos:TYPE:3> != 120:2'
    - '     @AND s <getblocklos:TYPE:3> != 120:3'
    - '     @AND s <getblocklos:TYPE:3> != 120:4'
    - '     @AND s <getblocklos:TYPE:3> != 120:5'
    - '     @AND s <getblocklos:TYPE:3> != 120:6'
    - '     @AND s <getblocklos:TYPE:3> != 120:7'
    - '     @AND s <getblocklos:TYPE:3> != 120:8'
    - '         @CMDOP vtclickview'
    - '         @PLAYER &4You FAILED to place the Eye of Ender on the Ender Portal Frame while it was still enchanted. 
    Once it it enchanted you must not look away from the ender portal frame or it will lose its charge. STARTING OVER PLEASE WAIT&r'
    - '         @IF b <takeitem:<playername>:381:1> = True'
    - '             @PLAYER &8LOG Eye of Ender Taken&r'
    - '         @ENDIF'
    - '         @SETBOOL $<playername>.StartOverTmp True'
    - '         @SETBOOL $<playername>.LOSCheckTmp True'
    - '     @ENDIF'
    - ' @ENDIF'
    - ' @IF i $<playername>.WhileCheckTimeLimitTotalTmp >= 1500'
    - ' @AND b $<playername>.LOSCheckTmp != True'
    - '     @PLAYER &4You took to long.&r Your time limit was 5 minutes. Contact an admin if you think this was due to bug or if you want to try to place the script again.'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '     @EXIT'
    - ' @ENDIF'
    - ' @PAUSE 0.2'
    - '@ENDWHILE'
    - '@DELVAR b $<playername>.LOSCheckTmp'
# This is the retry if the player fails to look at the ender portal frame while the eye is charged.    
    - '@IF b $<playername>.StartOverTmp = True'
    - ' @CMDOP vtclickview'
    - ' @PAUSE 7'
    - ' @PLAYER &4Ignore the text that just appears above and this time get it right! Remember to read the directions!&r'
    - ' @PAUSE 5'
    - ' @DELVAR b $<playername>.StartOverTmp'
    - ' @CALL Shared:PlaceScript'
    - '@ENDIF'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '@DELVAR b $<playername>.LOSCheckTmp'
    - '@DELVAR s $<playername>.LOSLocTmp'
    - '@DELVAR b $<playername>.StartOverTmp'
    - '@DELVAR s $<playername>.BlockTypeTMP'
  BowCheck:
    Script:
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '@PLAYER &4...&r(Hold Left Shift To Continue)'
    - '@PAUSE 4'
    - '@WHILE b <issneaking:> != true'
    - ' @PAUSE 2'
    - ' @ADDINT $<playername>.WhileCheckTimeLimitTmp 2'
    - ' @IF i $<playername>.WhileCheckTimeLimitTmp >= 60'
    - '     @SETINT $<playername>.WhileCheckTimeLimitTmp 0'
    - '     @ADDINT $<playername>.WhileCheckTimeLimitTotalTmp 60'
    - '     @PLAYER &4... You still need to move to the next step. Hold shift down (or whatever button makes you sneak or crouch) to continue when you are ready&r'
    - ' @ENDIF'
    - ' @IF i $<playername>.WhileCheckTimeLimitTotalTmp >= 300'
    - '     @PLAYER &4Time limit of 5 mins reached. You will now be forced to move to the next step.&r'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '     @EXIT'
    - ' @ENDIF'
    - ' @IF b $<playername>.CommandCancel = true'
    - '     @PLAYER Action Canceled'
    - '     @DELVAR b $<playername>.CommandCancel'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '     @DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
    - '     @EXIT'
    - ' @ENDIF'
    - '@ENDWHILE'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTmp'
    - '@DELVAR i $<playername>.WhileCheckTimeLimitTotalTmp'
  NextStep:
    Script:
# SEE ConstructionYard:Settle and Settle1 for example.    
#    - '         @SETSTR $<playername>.NextScript ConstructionYard:Settle1'
#    - '         @SETSTR $<playername>.NextScriptText You have claimed this plot of land as your own and have started a town named <cmdarg:2> and started to create a Construction Yard named <cmdarg:3>. You feel power eminating from the ender portal frame and as you walk near it. A sudden rush of magical energy engulfs you. Remember &4...&r means there is more text or another step. Hold shift(bow) for 2 seconds to move on.'
#    - '         @CALL Shared:NextStep'
# Removed the two below because I want on Login to work right so I added it to the NextScript variable making it simpler.
#    - '@ADDINT $<playername>.<var:$<playername>.CurrentScript>TMPStepCount 1'
#    - '@ADDSTR $<playername>.CurrentScript $<playername>.<var:$<playername>.CurrentScript>TMPStepCount'
    - '@SETBOOL $<playername>.CommandNextWaiting true'
    - '@PLAYER $<playername>.NextScriptText'
    - '@PLAYER &4...&r(Type &4/njs next&r To Continue)'
    - '@PAUSE 4'
    - '@WHILE b $<playername>.CommandNext != true'
    - ' @IF b $<playername>.CommandCancel = true'
    - '     @PLAYER Action Canceled'
    - '     @DELVAR b $<playername>.CommandCancel'
    - '     @DELVAR b $<playername>.CommandNextWaiting'
    - '     @DELVAR i $<playername>.TMPShiftCheckLoops'
    - '     @DELVAR s $<playername>.NextScript'
    - '     @DELVAR b $<playername>.CommandNext'
    - '     @EXIT'
    - ' @ENDIF'
    - ' @PAUSE 2'
    - ' @ADDINT $<playername>.TMPShiftCheckLoops 2'
    - ' @IF i $<playername>.TMPShiftCheckLoops = 120'
    - '     @PLAYER $<playername>.NextScriptText'
    - '     @PLAYER &4... Type &4/njs next&r. When you are ready to move to the next step.&r'
    - '     @DELVAR i $<playername>.TMPShiftCheckLoops'
    - ' @ENDIF'
    - '@ENDWHILE'
    - '@DELVAR i $<playername>.TMPShiftCheckLoops'
    - '@DELVAR b $<playername>.CommandNextWaiting'
    - '@DELVAR b $<playername>.CommandNext'
    - '@CALL $<playername>.NextScript'
  RouteCheck:
    Script:
    - '@IF b $<playername>.RouteCheck = true'
    - ' @ADDINT $<playername>.TempID 1'
    - ' @SETSTR $<playername>.CurrentRouteBuildingID<var:$<playername>.TempID> $<playername>.CurrentBuildingID'
    - ' @SETSTR $<playername>.CurrentRouteBuildingCategory<var:$<playername>.TempID> $<playername>.CurrentBuildingCategory'
    - ' @SETSTR $<playername>.CurrentRouteAction<var:$<playername>.TempID> $<playername>.Action'
    - '@ENDIF'
  PlayernameCreativeBlockPlacedEvent:
    Script:
#Check for Ender Portal Frame facing any direction  
    - '@IF s <blocktype> = 120:0'
    - '@OR s <blocktype> = 120:1'
    - '@OR s <blocktype> = 120:2'
    - '@OR s <blocktype> = 120:3'
    - ' @SETSTR $<playername>.BlockPlacedScript Passed'
    - ' @PLAYER You just placed an Ender Portal Frame.'
    - '@ENDIF'
#Check for Ender Portal frame filled with eye    
    - '@IF s <blocktype> = 120:5'
    - '@OR s <blocktype> = 120:6'
    - '@OR s <blocktype> = 120:7'
    - '@OR s <blocktype> = 120:8'
    - ' @PLAYER You are not allowed to place this block. Removing it now.'
    - ' @SETBLOCK 0:0 <triggerloc>'
    - '@ENDIF'
  brainstormingBlockCheck:
    Script:
    - '@PLAYER Location: <triggerloc>'
    - '@IF b <isblocktype:<triggerloc>:120:0> = True'
    - ' @PLAYER Test passed'
    - '@ELSE'
    - ' @PLAYER Failed same location test'
    - ' @SETINT $<playername>.CurrentBlockCheckLoc 0'
    - ' @LOOP 2'
    - ' @ADDINT $<playername>.CurrentBlockCheckLoc 1'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:$<playername>.CurrentBlockCheckLoc,0,0>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:0,$<playername>.CurrentBlockCheckLoc,0>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'    
    - '@ENDIF'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:0,0,$<playername>.CurrentBlockCheckLoc>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'    
    - '@ENDIF'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:-$<playername>.CurrentBlockCheckLoc,0,0>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:0,-$<playername>.CurrentBlockCheckLoc,0>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'    
    - '@ENDIF'
    - ' @SETSTR $<playername>.CurrentPowerLocation <relativeloc:<triggerloc>:0,0,-$<playername>.CurrentBlockCheckLoc>'
    - ' @PLAYER New Location: $<playername>.CurrentPowerLocation'
    - ' @IF b <isblocktype:$<playername>.CurrentPowerLocation:120:0> = True'
    - '     @PLAYER Test passed'
    - ' @ELSE'
    - '     @PLAYER Test Failed'
    - ' @ENDIF'    
    - '@ENDIF'
    - '@ENDLOOP'
  BlockLOSCheck:
    Script:
    - '@PLAYER <getblocklos:TYPE:20>'
  BEC:
# Just tells the player the material name and item id of the block they have equipped. type /vt run Shared:BEC
    Script:
    - '@PLAYER Material Name <helditemname> !!! Item ID <itemid>'  
  FindCommandBlock:
    Script:
#    - '@PLAYER &8LOG my name is <playername> and location <currentloc:<playername>> starting Shared FindCommandBlock script'
    - '@SETSTR $<playername>.FoundCommandBlock DEL'
    - '@SETSTR $<playername>.CommandBlockLoc DEL'
    - '@SETSTR $<playername>.FCBLocTMP DEL'
    - '@SETINT $<playername>.FCBStep 0'
    - '@SETINT $<playername>.FCBStepsRan 0'
    - '@SETSTR $<playername>.FCBBlockTMP DEL'
    - '@SETSTR $<playername>.FCBLocTMP <currentloc:<playername>>'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,5,0>'
    - '@WHILE s $<playername>.FoundCommandBlock != True'
    - ' @GETBLOCK $<playername>.FCBBlockTMP $<playername>.FCBLocTMP'
#    - ' @SETBLOCK 35:14 $<playername>.FCBLocTMP'
#    - ' @PAUSE 0.2'
#    - ' @IF s $<playername>.FCBBlockTMP != 0:0'
#    - '@PLAYER &8LOG Check $<playername>.FCBStep Loc $<playername>.FCBLocTMP Block $<playername>.FCBBlockTMP'
#    - ' @ENDIF'
    - ' @IF s $<playername>.FCBBlockTMP = 137:0'
    - ' @OR s $<playername>.FCBBlockTMP = 137:1'
    - '   @SETSTR $<playername>.CommandBlockLoc $<playername>.FCBLocTMP'
    - '   @SETSTR $<playername>.FoundCommandBlock True'
#    - '  @CALL Shared:FCBDOE'
#    - '@PLAYER &8LOG CommandBlock Found at Loc $<playername>.CommandBlockLoc'
    - ' @EXIT'
    - ' @ELSE'
    - '   @ADDINT $<playername>.FCBStep 1'
    - '   @IF i $<playername>.FCBStepsRan >= 10'
#    - '     @CALL Shared:FCBDOE'
#    - '@PLAYER &8LOG all FCBStepsRan No CommandBlock found closing script.'
    - '     @EXIT'
    - '   @ENDIF'
    - '   @CALL Shared:$<worldname>.<playername>CheckType'
    - ' @ENDIF'
    - '@ENDWHILE'
#    - '@CALL Shared:FCBDOE'
  Y-1Check:
    Script:
    - '@IF i $<playername>.FCBStep = 1'
    - ' @SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,-6,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep = 2'
    - ' @ADDINT $<playername>.FCBStepsRan 10'
    - '@ENDIF'
  SpiralCheck:
    Script:
    - '@IF i $<playername>.FCBStep = 1'
    - ' @SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep = 2'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 3'
    - '@AND i $<playername>.FCBStep <= 4'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:-1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 5'
    - '@AND i $<playername>.FCBStep <= 6'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,-1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 7'
    - '@AND i $<playername>.FCBStep <= 9'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 10'
    - '@AND i $<playername>.FCBStep <= 12'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 13'
    - '@AND i $<playername>.FCBStep <= 16'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:-1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 17'
    - '@AND i $<playername>.FCBStep <= 20'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,-1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 21'
    - '@AND i $<playername>.FCBStep <= 25'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 26'
    - '@AND i $<playername>.FCBStep <= 30'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 31'
    - '@AND i $<playername>.FCBStep <= 36'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:-1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 37'
    - '@AND i $<playername>.FCBStep <= 42'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,-1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 43'
    - '@AND i $<playername>.FCBStep <= 49'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 50'
    - '@AND i $<playername>.FCBStep <= 56'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 57'
    - '@AND i $<playername>.FCBStep <= 64'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:-1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 65'
    - '@AND i $<playername>.FCBStep <= 72'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,-1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 73'
    - '@AND i $<playername>.FCBStep <= 81'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 82'
    - '@AND i $<playername>.FCBStep <= 90'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:0,0,1>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep >= 91'
    - '@AND i $<playername>.FCBStep <= 99'
    - '@SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:-1,0,0>'
    - '@ENDIF'
    - '@IF i $<playername>.FCBStep = 100'
    - ' @SETSTR $<playername>.FCBLocTMP <relativeloc:$<playername>.FCBLocTMP:4,-1,-5>'
    - ' @SETINT $<playername>.FCBStep 0'
    - ' @ADDINT $<playername>.FCBStepsRan 1'
    - '@ENDIF'
  FCBDOE:
    Script:
    - '@DELVAR s $<playername>.FCBLocTMP'
    - '@DELVAR i $<playername>.FCBStep'
    - '@DELVAR i $<playername>.FCBStepsRan'
    - '@DELVAR s $<playername>.FCBBlockTMP'
  BuildingLedger:
    Script:
#    - '@SETSTR $<worldname>.<playername>BuildingID $<worldname>.<playername>BuildingCategory'
#    - '@CALL Shared:BuildingID'
#    - '@PLAYER &8LOG Team1012 $<playername>.SMTeam'
    - '@CALL Shared:FindCommandBlock'
    - '@IF s $<playername>.FoundCommandBlock = True'
    - ' @SETSTR $<worldname>.<playername>CoordsFixed $<playername>.CommandBlockLoc'
    - ' @CALL Shared:CleanCoordsID'
#    - '@PLAYER &8LOG FixLocTMP $<playername>.FixLocTMP'
    - ' @SETSTR $<worldname>.<playername>BuildingID $<worldname>.<playername>CoordsFixed'
#    - '@PLAYER &8LOG BuildingID set $<worldname>.<playername>BuildingID'
    - ' @SETSTR $<worldname>.<playername>CoordsFixed Deleted'
#    - '@PLAYER &8LOG Team1025 $<playername>.SMTeam'
#    - '@ADDINT $<var:$<playername>.ActivePlans>.LedgerID 1'
#    - '@ADDSTR $<worldname>.<playername>BuildingID $<var:$<worldname>.<playername>BuildingType>.LedgerID'
    - '@SETSTR $<worldname>.<var:$<worldname>.<playername>BuildingID>Category $<worldname>.<playername>ActivePlans'
    - '@SETSTR $<worldname>.<var:$<worldname>.<playername>BuildingID>Town $<worldname>.<playername>CurrentTown'
    - '@SETSTR $<worldname>.<var:$<worldname>.<playername>BuildingID>Owner $<playername>.SMTeam'
#    - ' @SETINT $<worldname>.<var:$<worldname>.<playername>BuildingID>Price $<playername>.LedgerPriceSelection'
#    - '@SETSTR $<worldname>.<var:$<worldname>.<playername>BuildingID>Schematic $<worldname>.<playername>PlanSchematic'
    - '@SETINT $<worldname>.<var:$<worldname>.<playername>BuildingID>Level 1'
    - '@SETSTR $<worldname>.<var:$<worldname>.<playername>BuildingID>Direction $<worldname>.<var:$<playername>.SMTeam>BuildingDirection'
#    - '@PLAYER &8LOG Team1033 $<playername>.SMTeam'
# Figure out how to get pop control back in later.
#    - '@SETINT $<worldname>.<var:$<worldname>.<playername>BuildingID>Pop $<playername>.CurProjPopTMP'
#    - '@DELVAR b $<playername>.SchematicLoaded'
#    - '@DELVAR s $<worldname>.<playername>BuildingType'
#    - '@DELVAR s $<playername>.CurProjTownTMP'
#    - '@DELVAR i $<playername>.CurProjPopTMP'
#     Name: $<worldname>.<var:$<worldname>.<playername>BuildingID>Name
#     Holds Population of: $<worldname>.<var:$<worldname>.<playername>BuildingID>Pop'
    - ' @CMDOP hd create $<worldname>.<playername>BuildingID'
    - ' @CMDCON hd setline $<worldname>.<playername>BuildingID 1 <var:$HardWorld.<playername>ColorCode> $<playername>.SMTeam $<worldname>.<var:$<worldname>.<playername>BuildingID>Category'
    - ' @IF s $<worldname>.<var:$<worldname>.<playername>BuildingID>Category = Flag'
    - '   @CMDCON hd addline $<worldname>.<playername>BuildingID &bTech: None Selected 0/5'
    - '   @CMDCON hd addline $<worldname>.<playername>BuildingID &4Stand on CommandBlock'
    - '   @CMDCON hd addline $<worldname>.<playername>BuildingID &4Type (/mi) - ACTIVATE BUILDING'
    - ' @ENDIF'
    - '@PLAYER You document the following into your ledger.
    ID: $<worldname>.<playername>BuildingID 
    Category: $<worldname>.<var:$<worldname>.<playername>BuildingID>Category 
    Owner: $<worldname>.<var:$<worldname>.<playername>BuildingID>Owner'
    - '@CMDCON title <playername> title {text:"Building $<worldname>.<var:$<worldname>.<playername>BuildingID>Category Activated ",color:red}'
    - '@CMDCON title <playername> subtitle {text:"your team can now build other structures.",color:yellow}'
    - '@SETBOOL $<worldname>.<var:$<playername>.SMTeam>ActivateCB False'
    - '@SETBOOL $<worldname>.<playername>ActivateCBLoop False'
    - '@SETINT $<worldname>.<playername>ActivateCBTime 0'
  IDGenerator:
    Script:
#    - '@SETSTR $<playername>.WhileForever True'
    - '@LOOP $BuildingID.Count'
    - ' @ADDINT $<playername>.TmpINTCount 1'
    - ' @PLAYER &8LOG TmpIntCount $<playername>.TmpINTCount'
    - ' @IF s $BuildingID.<var:$<playername>.TmpINTCount> = $<playername>.BuildingTestLoc'
    - '     @SETINT $<playername>.BuildingID $<playername>.TmpINTCount'
    - '     @CALL Shared:IDDOE'
    - '     @EXIT'
    - ' @ENDIF'
    - '@ENDLOOP'
    - '@ADDINT $BuildingID.Count 1'
    - '@SETSTR $BuildingID.<var:$BuildingID.Count> $<playername>.BuildingTestLoc'
    - '@SETINT $<playername>.BuildingID $BuildingID.Count'
    - '@CALL Shared:IDDOE'
  IDDOE:
    Script:
    - '@DELVAR i $<playername>.TmpINTCount'
    - '@DELVAR s $<playername>.WhileForever'
  FlagDistanceCheck:
    Script:
# A check for placing any building to prevent people building them over enemy defences.
    - '@SETBOOL $<worldname>.<playername>FlagDistancePassed False' 
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Red'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Purple'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Green'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Black'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Blue'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Magenta'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Yellow'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Gray'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor White'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Dark_Blue'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Dark_Green'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Dark_Aqua'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Dark_Red'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Gold'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Dark_Gray'
    - '@CALL Shared:FlagDistanceCheck2'
    - '@SETSTR $<worldname>.<playername>FlagCheckColor Aqua'
    - '@CALL Shared:FlagDistanceCheck2'
  FlagDistanceCheck2:
    Script:
# A check for placing any building to prevent people building them over enemy defences.
    - '@IF i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth'
    - ' @SETINT $<worldname>.<playername>FlagCheckMaxBorder $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast'
    - '@ENDIF'
    - '@IF i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth'
    - ' @SETINT $<worldname>.<playername>FlagCheckMaxBorder $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest'
    - '@ENDIF'
    - '@IF i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest'
    - ' @SETINT $<worldname>.<playername>FlagCheckMaxBorder $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth'
    - '@ENDIF'
    - '@IF i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizeeast'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizesouth'
    - '@AND i $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth > $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizewest'
    - ' @SETINT $<worldname>.<playername>FlagCheckMaxBorder $<worldname>.<var:$<worldname>.<playername>FlagCheckColor>TownSizenorth'
    - '@ENDIF'
    - '@ADDINT $<worldname>.<playername>FlagCheckMaxBorder 25'
    - '@PLAYER &8LOG Distance <distance:$<worldname>.<var:$<worldname>.<playername>FlagCheckColor>FlagSpawn:<currentloc:<playername>>> MaxBorder $<worldname>.<playername>FlagCheckMaxBorder FlagColor $<worldname>.<playername>FlagCheckColor'
    - '@IF b $<var:$<worldname>.<playername>FlagCheckColor>.TeamSpawnSet = True'
    - '@AND s $<playername>.SMTeam != $<worldname>.<playername>FlagCheckColor'
    - ' @IF i <distance:$<worldname>.<var:$<worldname>.<playername>FlagCheckColor>FlagSpawn:<currentloc:<playername>>> > $<worldname>.<playername>FlagCheckMaxBorder'
    - '   @SETBOOL $<worldname>.<playername>FlagDistancePassed True'
    - ' @ENDIF'
    - '@ENDIF'
  DirectionFacing:
    Script:
    - '@PLAYER &8LOG <direction:TEXT>'
    - '@IF s <direction:TEXT> = NORTH'
    - '@OR s <direction:TEXT> = NORTH_EAST'
    - '@OR s <direction:TEXT> = NORTH_NORTH_EAST'
    - '@OR s <direction:TEXT> = NORTH_NORTH_WEST'
    - '@OR s <direction:TEXT> = NORTH_WEST'
    - ' @SETSTR $<worldname>.<playername>DirectionFacing North'
    - '@ENDIF'
    - '@IF s <direction:TEXT> = SOUTH'
    - '@OR s <direction:TEXT> = SOUTH_SOUTH_EAST'
    - '@OR s <direction:TEXT> = SOUTH_EAST'
    - '@OR s <direction:TEXT> = SOUTH_SOUTH_WEST'
    - '@OR s <direction:TEXT> = SOUTH_WEST'
    - ' @SETSTR $<worldname>.<playername>DirectionFacing South'
    - '@ENDIF'
    - '@IF s <direction:TEXT> = EAST'
    - '@OR s <direction:TEXT> = EAST_SOUTH_EAST'
    - '@OR s <direction:TEXT> = EAST_NORTH_EAST'
    - ' @SETSTR $<worldname>.<playername>DirectionFacing East'
    - '@ENDIF'
    - '@IF s <direction:TEXT> = WEST'
    - '@OR s <direction:TEXT> = WEST_SOUTH_WEST'
    - '@OR s <direction:TEXT> = WEST_NORTH_WEST'
    - ' @SETSTR $<worldname>.<playername>DirectionFacing West'
    - '@ENDIF'
  CleanCoordsID:
    Script:
    - '@CALL Shared:CleanCoords'
    - '@SETSTR $<worldname>.<playername>Coords $<worldname>.<playername>CoordsFixed'
    - '@SETINT $<worldname>.<playername>Pointer 1'
    - '@IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> = -'
    - ' @SETSTR $<worldname>.<playername>CoordsFixed N'
    - '@ELSE'
    - ' @SETSTR $<worldname>.<playername>CoordsFixed <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer>'
    - '@ENDIF'
    - '@GETSTRLEN $<worldname>.<playername>Strlen $<worldname>.<playername>Coords'
    - '@SUBINT $<worldname>.<playername>Strlen 1'
    - '@LOOP $<worldname>.<playername>Strlen'
    - ' @ADDINT $<worldname>.<playername>Pointer 1'
#    - ' @SETSTR $<worldname>.<playername>CoordsFixed <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer>'
    - ' @IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> = -'
    - '   @ADDSTR $<worldname>.<playername>CoordsFixed N'
    - ' @ENDIF'
    - ' @IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> = ,'
    - '   @ADDSTR $<worldname>.<playername>CoordsFixed C'
    - ' @ENDIF'
    - ' @IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> != -'
    - ' @AND s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> != ,'
    - '   @ADDSTR $<worldname>.<playername>CoordsFixed <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer>'
    - ' @ENDIF'
    - '@ENDLOOP'
#    - '@PLAYER &8LOG ID Run $<worldname>.<playername>CoordsFixed'
  CleanCoords:
    Script:
    - '@SETSTR $<worldname>.<playername>Coords $<worldname>.<playername>CoordsFixed'
    - '@SETINT $<worldname>.<playername>Pointer 1'
    - '@GETSTRLEN $<worldname>.<playername>Strlen $<worldname>.<playername>Coords'
    - '@SUBINT $<worldname>.<playername>Strlen 9'
    - '@SETSTR $<worldname>.<playername>CoordsFixed <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer>'
    - '@LOOP $<worldname>.<playername>Strlen'
    - '  @ADDINT $<worldname>.<playername>Pointer 1'
    - '  @SETINT $<worldname>.<playername>Pntr1 $<worldname>.<playername>Pointer'
    - '  @ADDINT $<worldname>.<playername>Pntr1 1'
    - '  @SETINT $<worldname>.<playername>Pntr3 $<worldname>.<playername>Pointer'
    - '  @ADDINT $<worldname>.<playername>Pntr3 3'
    - '  @IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> = .'
    - '  @AND s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pntr1> = 0'
    - '  @AND s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pntr3> = 0'
    - '    @BREAKLOOP'
    - '  @ENDIF'
    - '  @IF s <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer> = .'
    - '    @ADDINT $<worldname>.<playername>Pointer 2'
    - '  @ENDIF'
    - '  @ADDSTR $<worldname>.<playername>CoordsFixed <getchar:$<worldname>.<playername>Coords:$<worldname>.<playername>Pointer>'
    - '@ENDLOOP'
#    - '@PLAYER &8LOG First Run $<worldname>.<playername>CoordsFixed'
#    - '@CMDOP vt delobj Local'
  PrintPos:
    Script:
    - '@SETSTR $<worldname>.<playername>CoordsFixed <relativeloc:<playerloc>:10,10,10>'
    - '@PLAYER &a<var:$<worldname>.<playername>CoordsFixed>'
    - '@CALL Shared:CleanCoords'
    - '@PLAYER &a<var:$<worldname>.<playername>CoordsFixed>'
    - '@CMDOP /pos1 <var:$<worldname>.<playername>CoordsFixed>'
  TestID:
    Script:
    - '@SETSTR $<worldname>.<playername>CoordsFixed $<playername>.CommandBlockLoc'
    - '@PLAYER &aOLD <var:$<worldname>.<playername>CoordsFixed>'
    - '@CALL Shared:CleanCoords'
    - '@PLAYER &aNEW <var:$<worldname>.<playername>CoordsFixed>'
  Build:
    Script:
    - '@OPENINV LOADING'
    - '@IF b $<worldname>.<var:$<playername>.SMTeam>PlanActive = True'
    - ' @CMDOP /undo'
    - ' @CMDOP /undo'
    - ' @SETBOOL $<worldname>.<var:$<playername>.SMTeam>PlanActive False'
    - '@ENDIF'
    - '@PAUSE 1'
    - '@TP $<worldname>.<playername>PlanStartLoc'
    - '@PAUSE 0.5'
    - '@OPENINV LOADING6'
    - '@SETSTR $<worldname>.<playername>ActivePlans $<worldname>.<playername>PlanSchematic'
    - '@ADDSTR $<worldname>.<playername>PlanSchematic $<worldname>.<playername>PlanSchematicDirection'
    - '@CMDOP builder load $<worldname>.<playername>PlanSchematic'
    - '@CMDOP builder timeout 0.5'
    - '@SETSTR $<worldname>.<var:$<playername>.SMTeam>BuildingDirection $<worldname>.<playername>PlanSchematicDirection'
    - '@PAUSE 1'
    - '@OPENINV LOADING8'
    - '@CMDOP builder build ignoreair oncancel:BuildCancel oncomplete:BuildComplete'
    - '@SETBOOL $<worldname>.<var:$<playername>.SMTeam>Building True'
    - '@CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanSchematic> Construction Started",color:red}'
    - '@CMDCON title <playername> subtitle {text:"You will be teleported back to this location when the <var:$<worldname>.<playername>PlanSchematic> has been completed.",color:yellow}'    
    - '@PLAYER Your team will not be able to build another building until you have completed this structure.'
    - '@PAUSE 0.5'
    - '@CLOSEINV <playername>'
  BuildCancel:
    Script:
    - '@PLAYER You cancelled your build and your team can now start another building.'
    - '@SETBOOL $<worldname>.<var:$<playername>.SMTeam>Building False'
    - '@SETBOOL $<worldname>.<playername>PlanSchematicUpgradable False'    
  BuildComplete:
    Script:
    - '@IF s $<worldname>.<var:$<playername>.SMTeam>Planner != <playername>'
    - ' @SETSTR $<worldname>.<playername>PlanStartLoc $<worldname>.<var:$<playername>.SMTeam>PlanStartLoc'
    - ' @SETBOOL $<worldname>.<playername>PlanSchematicUpgradable $<worldname>.<var:$<playername>.SMTeam>PlanSchematicUpgradable'
    - ' @SETSTR $<worldname>.<playername>PlanSchematicDirection $<worldname>.<var:$<playername>.SMTeam>PlanSchematicDirection'
    - ' @SETSTR $<worldname>.<playername>PlanSchematicID $<worldname>.<var:$<playername>.SMTeam>PlanSchematicID'
    - ' @SETSTR $<worldname>.<playername>PlanSchematic $<worldname>.<var:$<playername>.SMTeam>PlanSchematic'
    - ' @SETSTR $<worldname>.<playername>ActivePlans $<worldname>.<var:$<playername>.SMTeam>ActivePlans'    
    - '@ENDIF'
    - '@TP $<worldname>.<playername>PlanStartLoc'
    - '@PAUSE 2'
    - '@CMDOP removenear SNOW_BLOCK 30'
    - '@IF b $<worldname>.<playername>PlanSchematicUpgradable = True'
    - ' @ADDINT $<worldname>.<var:$<worldname>.<playername>PlanSchematicID>Level 1'
    - ' @CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanSchematic> Upgrade Completed",color:red}'
    - ' @PLAYER Your $<worldname>.<playername>PlanSchematic upgrade has been completed.'
    - '@ELSE'
    - ' @SETBOOL $<worldname>.<var:$<playername>.SMTeam>ActivateCB True'
    - ' @SETBOOL $<worldname>.<playername>ActivateCBLoop True'
    - ' @WHILE b $<worldname>.<playername>ActivateCBLoop = True'
    - '   @CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanSchematic> Has Been Built",color:red}'
    - '   @CMDCON title <playername> subtitle {text:"stand over the commandblock and type /mi - ACTIVATE BUILDING",color:yellow}'
    - '   @PLAYER Your $<worldname>.<playername>PlanSchematic has been completed. To activate it walk over the commandblock and type /mi and select the Redstone block. Do this now! Only once it is activated will your team be able to build more buildings.'
    - '   @PAUSE 5'
    - '   @ADDINT $<worldname>.<playername>ActivateCBTime 5'
    - '   @CMDCON title <playername> subtitle {text:"You have <var:$<worldname>.<playername>PlanActiveTime>/240 Time Left",color:yellow}'
    - '   @PAUSE 55'
    - '   @ADDINT $<worldname>.<playername>ActivateCBTime 55'
    - '   @IF i $<worldname>.<playername>ActivateCBTime >= 300'
    - '     @CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanSchematic> Activation Timed Out",color:red}'
    - '     @CMDCON title <playername> subtitle {text:"You will need to run the build command again.",color:yellow}'
    - '     @SETBOOL $<worldname>.<playername>ActivateCBLoop False'
    - '     @SETINT $<worldname>.<playername>ActivateCBTime 0'
    - '   @ELSE'
    - '     @IF b $<worldname>.<playername>ActivateCBLoop = True'
    - '       @TP $<worldname>.<playername>PlanStartLoc'
    - '     @ENDIF'
    - '   @ENDIF'
    - ' @ENDWHILE'
    - ' @SETINT $<worldname>.<playername>ActivateCBTime 0'
    - '@ENDIF'
    - '@SETBOOL $<worldname>.<playername>PlanSchematicUpgradable False'    
    - '@SETBOOL $<worldname>.<var:$<playername>.SMTeam>Building False' 
  Plan:
    Script:
    - '@IF b $<worldname>.<var:$<playername>.SMTeam>PlanActive != True'
    - '  @OPENINV LOADING'
#    - '  @CALL Shared:FlagDistanceCheck'
#    - '  @IF b $<worldname>.<playername>FlagDistancePassed = True'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>Planner <playername>'
    - '    @SETSTR $<worldname>.<playername>PlanStartLoc <playerloc>'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>PlanStartLoc <playerloc>'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>ActivePlans $<worldname>.<playername>ActivePlans'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>PlanSchematic $<worldname>.<playername>PlanSchematic'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>PlanSchematicID $<worldname>.<playername>PlanSchematicID'
    - '    @SETSTR $<worldname>.<var:$<playername>.SMTeam>PlanSchematicDirection $<worldname>.<playername>PlanSchematicDirection'
    - '    @SETBOOL $<worldname>.<var:$<playername>.SMTeam>PlanSchematicUpgradable $<worldname>.<playername>PlanSchematicUpgradable'    
    - '    @SETBOOL $<worldname>.<var:$<playername>.SMTeam>PlanActive True'
#    - '    @SETSTR $<worldname>.<playername>CoordsFixed $<worldname>.<playername>PlanLoc'
#    - '    @CALL Shared:CleanCoords'
#    - '    @SETSTR $<worldname>.<playername>PlanLoc $<worldname>.<playername>CoordsFixed'
#    - '    @TP $<worldname>.<playername>PlanLoc'
    - '    @CMDOP /schematic load $<worldname>.<playername>PlanSchematic'
    - '    @PAUSE 1'
    - '    @IF s $<worldname>.<playername>PlanSchematicDirection = East'
    - '      @CMDOP /rotate 90'
    - '      @PAUSE 0.5'
    - '    @ENDIF'
    - '    @IF s $<worldname>.<playername>PlanSchematicDirection = South'
    - '      @CMDOP /rotate 180'
    - '      @PAUSE 0.5'
    - '    @ENDIF'
    - '    @IF s $<worldname>.<playername>PlanSchematicDirection = West'
    - '      @CMDOP /rotate 270'
    - '      @PAUSE 0.5'
    - '    @ENDIF'
    - '    @CMDOP /paste -a'
    - '    @CMDOP npc create BobTheBuilder --trait builder'
    - '  @OPENINV LOADING5'
    - '    @PAUSE 1'
    - '     @CMDOP removenear SNOW_BLOCK 30'
    - '     @CMDOP npc nickname --set <var:$<playername>.SMTeam>'
    - '    @CMDOP builder supply true'
#    - '    @CMDOP builder supply false'
    - '    @CMDOP npc lookclose'
    - '    @SETINT $<worldname>.<playername>PlanLocX <playerloc:x>'
    - '    @ADDINT $<worldname>.<playername>PlanLocX $<worldname>.<playername>PlanLocChangeX'   
    - '    @SETINT $<worldname>.<playername>PlanLocY <playerloc:y>'
    - '    @ADDINT $<worldname>.<playername>PlanLocY $<worldname>.<playername>PlanLocChangeY'
    - '    @SETINT $<worldname>.<playername>PlanLocZ <playerloc:z>'
    - '    @ADDINT $<worldname>.<playername>PlanLocZ $<worldname>.<playername>PlanLocChangeZ'
    - '    @SETSTR $<worldname>.<playername>PlanLoc $<worldname>.<playername>PlanLocX'
    - '    @ADDSTR $<worldname>.<playername>PlanLoc ,<var:$<worldname>.<playername>PlanLocY>'
    - '    @ADDSTR $<worldname>.<playername>PlanLoc ,<var:$<worldname>.<playername>PlanLocZ>'
    - '    @CMDOP builder origin $<worldname>.<playername>PlanLoc'
    - '@PLAYER &8LOG Builder Origin Set To $<worldname>.<playername>PlanLoc'
    - '    @SETINT $<worldname>.<playername>PlanActiveTime 0'
    - '  @CLOSEINV <playername>'
    - '    @CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanSchematic> Plan Activated",color:red}'
    - '    @CMDCON title <playername> subtitle {text:"To Build, type /mi - Control Builder - Build Accepted Plan",color:yellow}'
    # Plan will be active for 30 seconds then will be removed
    - '    @WHILE b $<worldname>.<var:$<playername>.SMTeam>PlanActive = True'
    - '      @PAUSE 10'
    - '      @ADDINT $<worldname>.<playername>PlanActiveTime 10'
    - '      @CMDCON title <playername> title {text:"<var:$<worldname>.<playername>PlanActiveTime>/120 Time To Accept",color:red}'
    - '      @CMDCON title <playername> subtitle {text:"To Build, type /mi - Control Builder - Build Accepted Plan",color:yellow}'
    - '      @IF i $<worldname>.<playername>PlanActiveTime >= 120'
    - '        @CMDOP /undo'
    - '        @CMDOP /undo'
    - '        @CMDOP npc remove'
    - '        @SETBOOL $<worldname>.<var:$<playername>.SMTeam>PlanActive False'
    - '      @ENDIF'
    - '    @ENDWHILE'
#    - '  @ELSE'
#    - '    @PLAYER You are to close to your enemies borders to build move atleast 25 squares away and try to build again.'
#    - '  @ENDIF'
    - '@ELSE'
    - '  @PLAYER You have another plan still active. Clear the plan or build it before placing another plan.'
    - '@ENDIF'
  CitizenID:
    Script:
    - '@PLAYER Under Construction Test ID $<worldname>.<playername>SentryID'  
  CheckPoints:
    Script:
    - '@IF s <whodied> = Zombie'
    - ' @ADDINT $HardWorld.<playername>ZombieKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>ZombieKillCnt 1'
    - ' @IF i $HardWorld.<playername>ZombieKillCnt >= 30'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 30 Zombies adding 1 point.'
    - '   @SETINT $HardWorld.<playername>ZombieKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Pig_Zombie'
    - ' @ADDINT $HardWorld.<playername>Pig_ZombieKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>Pig_ZombieKillCnt 1'
    - ' @IF i $HardWorld.<playername>Pig_ZombieKillCnt >= 5'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 5 Pig_Zombies adding 1 point.'
    - '   @SETINT $HardWorld.<playername>Pig_ZombieKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Skeleton'
    - ' @ADDINT $HardWorld.<playername>SkeletonKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>SkeletonKillCnt 1'
    - ' @IF i $HardWorld.<playername>SkeletonKillCnt >= 20'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 20 Skeletons adding 1 point.'
    - '   @SETINT $HardWorld.<playername>SkeletonKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Creeper'
    - ' @ADDINT $HardWorld.<playername>CreeperKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>CreeperKillCnt 1'
    - ' @IF i $HardWorld.<playername>CreeperKillCnt >= 15'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 15 Creepers adding 1 point.'
    - '   @SETINT $HardWorld.<playername>CreeperKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Spider'
    - ' @ADDINT $HardWorld.<playername>SpiderKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>SpiderKillCnt 1'
    - ' @IF i $HardWorld.<playername>SpiderKillCnt >= 15'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 15 Spiders adding 1 point.'
    - '   @SETINT $HardWorld.<playername>SpiderKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Witch'
    - ' @ADDINT $HardWorld.<playername>WitchKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>WitchKillCnt 1'
    - ' @IF i $HardWorld.<playername>WitchKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 1 Witch adding 1 point.'
    - '   @SETINT $HardWorld.<playername>WitchKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Enderman'
    - ' @ADDINT $HardWorld.<playername>EndermanKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>EndermanKillCnt 1'
    - ' @IF i $HardWorld.<playername>EndermanKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 3'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed an Enderman adding 3 points.'
    - '   @SETINT $HardWorld.<playername>EndermanKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Cave_Spider'
    - ' @ADDINT $HardWorld.<playername>CaveSpiderKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>CaveSpiderKillCnt 1'
    - ' @IF i $HardWorld.<playername>CaveSpiderKillCnt >= 5'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 5 CaveSpiders adding 1 point.'
    - '   @SETINT $HardWorld.<playername>CaveSpiderKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Blaze'
    - ' @ADDINT $HardWorld.<playername>BlazeKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>BlazeKillCnt 1'
    - ' @IF i $HardWorld.<playername>BlazeKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Blaze adding 1 point.'
    - '   @SETINT $HardWorld.<playername>BlazeKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Slime'
    - ' @ADDINT $HardWorld.<playername>SlimeKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>SlimeKillCnt 1'
    - ' @IF i $HardWorld.<playername>SlimeKillCnt >= 10'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 10 Slime adding 1 point.'
    - '   @SETINT $HardWorld.<playername>SlimeKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Magma_Cube'
    - ' @ADDINT $HardWorld.<playername>Magma_CubeKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>Magma_CubeKillCnt 1'
    - ' @IF i $HardWorld.<playername>Magma_CubeKillCnt >= 6'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 6 Magma_Cube adding 1 point.'
    - '   @SETINT $HardWorld.<playername>Magma_CubeKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Silverfish'
    - ' @ADDINT $HardWorld.<playername>SilverfishKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>SilverfishKillCnt 1'
    - ' @IF i $HardWorld.<playername>SilverfishKillCnt >= 20'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed 20 Silverfish adding 1 point.'
    - '   @SETINT $HardWorld.<playername>SilverfishKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Bat'
    - ' @ADDINT $HardWorld.<playername>BatKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>BatKillCnt 1'
    - ' @IF i $HardWorld.<playername>BatKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 3'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Bat adding 3 points.'
    - '   @SETINT $HardWorld.<playername>BatKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Ghast'
    - ' @ADDINT $HardWorld.<playername>GhastKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>GhastKillCnt 1'
    - ' @IF i $HardWorld.<playername>GhastKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 3'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Ghast adding 3 points.'
    - '   @SETINT $HardWorld.<playername>GhastKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Giant'
    - ' @ADDINT $HardWorld.<playername>GiantKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>GiantKillCnt 1'
    - ' @IF i $HardWorld.<playername>GiantKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 25'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Giant adding 25 points.'
    - '   @SETINT $HardWorld.<playername>GiantKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Wither'
    - ' @ADDINT $HardWorld.<playername>WitherKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>WitherKillCnt 1'
    - ' @IF i $HardWorld.<playername>WitherKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 250'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Wither adding 250 points.'
    - '   @SETINT $HardWorld.<playername>WitherKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
    - '@IF s <whodied> = Ender_Dragon'
    - ' @ADDINT $HardWorld.<playername>Ender_DragonKillTotal 1'
    - ' @ADDINT $HardWorld.<playername>Ender_DragonKillCnt 1'
    - ' @IF i $HardWorld.<playername>Ender_DragonKillCnt >= 1'
    - '   @SETINT $HardWorld.<playername>PointsSelected 1000'
    - '   @CALL Shared:AddPoints'
    - '   @PLAYER Killed a Ender_Dragon adding 1000 points.'
    - '   @SETINT $HardWorld.<playername>Ender_DragonKillCnt 0'
    - ' @ENDIF'
    - '@ENDIF'
  AddPoints:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard $HardWorld.<playername>PointsSelected'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard $HardWorld.<playername>PointsSelected'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score $HardWorld.<playername>PointsSelected'
    - '@ADDINT $HardWorld.<playername>Score $HardWorld.<playername>PointsSelected'
    - '@CALL Flag:VictoryCondition'
  AddPoints1:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard 1'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard 1'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score 1'
    - '@ADDINT $HardWorld.<playername>Score 1'
    - '@CALL Flag:VictoryCondition'
  AddPoints2:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard 2'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard 2'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score 2'
    - '@ADDINT $HardWorld.<playername>Score 2'
    - '@CALL Flag:VictoryCondition'
  AddPoints3:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard 3'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard 3'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score 3'
    - '@ADDINT $HardWorld.<playername>Score 3'
    - '@CALL Flag:VictoryCondition'
  AddPoints4:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard 4'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard 4'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score 4'
    - '@ADDINT $HardWorld.<playername>Score 4'
    - '@CALL Flag:VictoryCondition'
  AddPoints5:
    Script:
    - '@CMDCON scoreboard players add <playername> LHard 5'
    - '@CMDCON scoreboard players add <var:$<playername>.SMTeam>Total SHard 5'
    - '@ADDINT $HardWorld.<var:$<playername>.SMTeam>Score 5'
    - '@ADDINT $HardWorld.<playername>Score 5'
    - '@CALL Flag:VictoryCondition'
  EndIEvent:
    Script:
#    - '@PLAYER End Call Scripts for Menu Inventory Check'
    - '@IF s <inventorytitle> ?= Ban'
    - ' @SWITCH i <clickedslot>'
    - '   @CASE 0'
    - '     @PLAYER Easter Egg Wounded_Fighter can be very annoying.'
    - ' @ENDSWITCH'
    - '@ENDIF'
  FirstJoin:
    Script:
    - '@IF b $<playername>.FirstJoin != true'
    - ' @SETBOOL $<playername>.FirstJoin true'
    - ' @PAUSE 0.5'
    - ' @CMDCON vt savevars'
    - '@ENDIF'
    - '@LOOP 3'
    - ' @CMDCON title <playername> title {text:"Welcome to Minecraft Impossible",color:red}'
    - ' @CMDCON title <playername> subtitle {text:"Type /mi to start your adventure",color:yellow}'
    - ' @PLAYER Welcome to Minecraft Impossible: Type /mi to start your adventure'
    - ' @PAUSE 5'
    - '@ENDLOOP'
  DemolishBuilding:
    Script:
    - '@IF b $<playername>.DemoRunning = true'
    - '  @CMDCON msg <playername> Deconstruction Failed'
    - '  @CMDCON title <playername> title {text:"Deconstruction Failed",color:red}'
    - '  @CMDCON title <playername> subtitle {text:"Cannot deconstruct more than one building at a time",color:yellow}'
    - '  @EXIT'
    - '@ENDIF'
    - '@SETBOOL $<playername>.DemoRunning true'
# msg to team
    - '@SETINT $<playername>.PlayersListCountTmp 0'
    # Send message to every player on a team.
    - '@LOOP @HardWorld.<var:$<playername>.SMTeam>PlayersList'
    - ' @SETSTR $<playername>.PlayersListStr @HardWorld.<var:$<playername>.SMTeam>PlayersList[<var:$<playername>.PlayersListCountTmp>]'
    - ' @CMDCON msg $<playername>.PlayersListStr <playername> has begun to deconstruct $<worldname>.<playername>BuildingSchematic'
    - ' @CMDCON title $<playername>.PlayersListStr title {text:"Deconstruction Started",color:red}'
    - ' @CMDCON title $<playername>.PlayersListStr subtitle {text:"<playername> has begun to deconstruct <var:$<worldname>.<playername>BuildingSchematic",color:yellow}'
    - ' @ADDINT $<playername>.PlayersListCountTmp 1'
    - '@ENDLOOP'
# get player location
    - '@SETINT $<playername>.PLocX <playerloc:x>'
    - '@SETINT $<playername>.PLocY <playerloc:y>'
    - '@SETINT $<playername>.PLocZ <playerloc:z>'
# Barracks List
    - '@ADDLIST @<playername>.BarracksList BarracksNorth'
    - '@ADDLIST @<playername>.BarracksList Barracks2North'
    - '@ADDLIST @<playername>.BarracksList Barracks3North'
    - '@ADDLIST @<playername>.BarracksList Barracks4North'
    - '@ADDLIST @<playername>.BarracksList Barracks5North'
    - '@ADDLIST @<playername>.BarracksList BarracksSouth'
    - '@ADDLIST @<playername>.BarracksList Barracks2South'
    - '@ADDLIST @<playername>.BarracksList Barracks3South'
    - '@ADDLIST @<playername>.BarracksList Barracks4South'
    - '@ADDLIST @<playername>.BarracksList Barracks5South'
    - '@ADDLIST @<playername>.BarracksList BarracksEast'
    - '@ADDLIST @<playername>.BarracksList Barracks2East'
    - '@ADDLIST @<playername>.BarracksList Barracks3East'
    - '@ADDLIST @<playername>.BarracksList Barracks4East'
    - '@ADDLIST @<playername>.BarracksList Barracks5East'
    - '@ADDLIST @<playername>.BarracksList BarracksWest'
    - '@ADDLIST @<playername>.BarracksList Barracks2West'
    - '@ADDLIST @<playername>.BarracksList Barracks3West'
    - '@ADDLIST @<playername>.BarracksList Barracks4West'
    - '@ADDLIST @<playername>.BarracksList Barracks5West'
# Set Barracks Locations and Population Reduction
    - '@SETINT $<playername>.ListCount 0'
    - '@LOOP @<playername>.BarracksList'
    - ' @SETSTR $<playername>.SchemListStr @<playername>.BarracksList[<var:$<playername>.ListCount>]'
    - ' @IF s $<playername>.SchemListStr = $<worldname>.<playername>BuildingSchematic'
    - '  @SETBOOL $<playername>.BarracksListCheck true'
    - ' @ENDIF'
    - ' @ADDINT $<playername>.ListCount 1'
    - '@ENDLOOP'
    - '@IF b $<playername>.BarracksListCheck = true'
    - '  @SETINT $<playername>.X1Adj 12'
    - '  @SETINT $<playername>.Y1Adj 7'
    - '  @SETINT $<playername>.Z1Adj 11'
    - '  @SETINT $<playername>.X2Adj -10'
    - '  @SETINT $<playername>.Y2Adj -6'
    - '  @SETINT $<playername>.Z2Adj -8'
    - '  @SWITCH i $<worldname>.<var:$<worldname>.<playername>BuildingID>Level'
    - '    @CASE 1'
    - '      @SUBINT $<worldname>.<var:$<playername>.SMTeam>PopLimit 6'
    - '    @CASE 2'
    - '      @SUBINT $<worldname>.<var:$<playername>.SMTeam>PopLimit 12'
    - '    @CASE 3'
    - '      @SUBINT $<worldname>.<var:$<playername>.SMTeam>PopLimit 18'
    - '    @CASE 4'
    - '      @SUBINT $<worldname>.<var:$<playername>.SMTeam>PopLimit 24'
    - '    @CASE 5'
    - '      @SUBINT $<worldname>.<var:$<playername>.SMTeam>PopLimit 30'
    - ' @ENDSWITCH'
    - '@ENDIF'
# Modify all schematic origin location variables based on direction
    - '@ADDINT $<playername>.Y1Adj $<playername>.PLocY'
    - '@SETINT $<playername>.SiteOriginY $<playername>.Y1Adj'
    - '@ADDINT $<playername>.Y2Adj $<playername>.PLocY'
    - '@SETINT $<playername>.SiteEndY $<playername>.Y2Adj'
    - '@BROADCAST &8LOG $<worldname>.<var:$<worldname>.<playername>BuildingID>Direction'
    - '@SWITCH s $<worldname>.<var:$<worldname>.<playername>BuildingID>Direction'
    - ' @CASE North'
    - '  @ADDINT $<playername>.X1Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteOriginX $<playername>.X1Adj'
    - '  @ADDINT $<playername>.Z1Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteOriginZ $<playername>.Z1Adj'
    - '  @ADDINT $<playername>.X2Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteEndX $<playername>.X2Adj'
    - '  @ADDINT $<playername>.Z2Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteEndZ $<playername>.Z2Adj'
    - ' @CASE East'
    - '  @MULINT $<playername>.Z2Adj -1'
    - '  @ADDINT $<playername>.Z2Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteOriginX $<playername>.Z2Adj'
    - '  @ADDINT $<playername>.X1Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteOriginZ $<playername>.X1Adj'
    - '  @MULINT $<playername>.Z1Adj -1'
    - '  @ADDINT $<playername>.Z1Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteEndX $<playername>.Z1Adj'
    - '  @ADDINT $<playername>.X2Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteEndZ $<playername>.X2Adj'
    - ' @CASE South'
    - '  @MULINT $<playername>.X2Adj -1'
    - '  @ADDINT $<playername>.X2Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteOriginX $<playername>.X2Adj'
    - '  @MULINT $<playername>.Z2Adj -1'
    - '  @ADDINT $<playername>.Z2Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteOriginZ $<playername>.Z2Adj'
    - '  @MULINT $<playername>.X1Adj -1'
    - '  @ADDINT $<playername>.X1Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteEndX $<playername>.X1Adj'
    - '  @MULINT $<playername>.Z1Adj -1'
    - '  @ADDINT $<playername>.Z1Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteEndZ $<playername>.Z1Adj'
    - ' @CASE West'
    - '  @ADDINT $<playername>.Z1Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteOriginX $<playername>.Z1Adj'
    - '  @MULINT $<playername>.X2Adj -1'
    - '  @ADDINT $<playername>.X2Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteOriginZ $<playername>.X2Adj'
    - '  @ADDINT $<playername>.Z2Adj $<playername>.PLocX'
    - '  @SETINT $<playername>.SiteEndX $<playername>.Z2Adj'
    - '  @MULINT $<playername>.X1Adj -1'
    - '  @ADDINT $<playername>.X1Adj $<playername>.PLocZ'
    - '  @SETINT $<playername>.SiteEndZ $<playername>.X1Adj'
    - '@ENDSWITCH'
    - '@BROADCAST &8LOG Origin $<playername>.SiteOriginX $<playername>.SiteOriginY $<playername>.SiteOriginZ'
    - '@BROADCAST &8LOG End $<playername>.SiteEndX $<playername>.SiteEndY $<playername>.SiteEndZ'
# deactivate ledger
    - '@DELVAR s $<worldname>.<var:$<worldname>.<playername>BuildingID>Category'
    - '@DELVAR s $<worldname>.<var:$<worldname>.<playername>BuildingID>Town'
    - '@DELVAR s $<worldname>.<var:$<worldname>.<playername>BuildingID>Owner'
    - '@DELVAR i $<worldname>.<var:$<worldname>.<playername>BuildingID>Price'
    - '@DELVAR s $<worldname>.<var:$<worldname>.<playername>BuildingID>Schematic'
    - '@DELVAR i $<worldname>.<var:$<worldname>.<playername>BuildingID>Level'
    - '@DELVAR s $<worldname>.<var:$<worldname>.<playername>BuildingID>Direction'
    - '@CMDOP hd delete $<worldname>.<playername>BuildingID'
# delete schematic command block
    - '@SUBINT $<playername>.PLocY 1'
    - '@CMDOP setblock $<playername>.PLocX $<playername>.PLocY $<playername>.PLocZ minecraft:snow'
# summon Bob or Evil Twin
#    - '@SETINT $<playername>.Randomizer <random1to:10>'
#    - '@IF i $<playername>.Randomizer > 9'
#    - '  @CALL Shared:EvilTwin'
#    - '@ELSE'
    - '  @CMDOP npc create <var:$<playername>.SMTeam>Bob --type PLAYER --trait builder'
    - '  @CMDOP builder load Empty'
    - '  @PAUSE 1'
    - '  @CMDOP builder build ignoreair onstart:BuildStart'
#    - '@ENDIF'
# set Mid values
    - '@SETINT $<playername>.SiteMidX $<playername>.SiteOriginX'
    - '@SETINT $<playername>.SiteMidY $<playername>.SiteOriginY'
    - '@SETINT $<playername>.SiteMidZ $<playername>.SiteOriginZ'
# block list
    - '@ADDLIST @<playername>.BlockList 0:0'
    - '@ADDLIST @<playername>.BlockList 1:0'
    - '@ADDLIST @<playername>.BlockList 1:1'
    - '@ADDLIST @<playername>.BlockList 1:3'
    - '@ADDLIST @<playername>.BlockList 1:5'
    - '@ADDLIST @<playername>.BlockList 2:0'
    - '@ADDLIST @<playername>.BlockList 3:0'
    - '@ADDLIST @<playername>.BlockList 3:1'
    - '@ADDLIST @<playername>.BlockList 7:0'
    - '@ADDLIST @<playername>.BlockList 8:0'
    - '@ADDLIST @<playername>.BlockList 9:0'
    - '@ADDLIST @<playername>.BlockList 10:0'
    - '@ADDLIST @<playername>.BlockList 11:0'
    - '@ADDLIST @<playername>.BlockList 12:0'
    - '@ADDLIST @<playername>.BlockList 12:1'
    - '@ADDLIST @<playername>.BlockList 13:0'
    - '@ADDLIST @<playername>.BlockList 14:0'
    - '@ADDLIST @<playername>.BlockList 15:0'
    - '@ADDLIST @<playername>.BlockList 16:0'
    - '@ADDLIST @<playername>.BlockList 21:0'
    - '@ADDLIST @<playername>.BlockList 49:0'
    - '@ADDLIST @<playername>.BlockList 56:0'
    - '@ADDLIST @<playername>.BlockList 73:0'
    - '@ADDLIST @<playername>.BlockList 74:0'
    - '@ADDLIST @<playername>.BlockList 78:0'
    - '@ADDLIST @<playername>.BlockList 79:0'
    - '@ADDLIST @<playername>.BlockList 80:0'
    - '@ADDLIST @<playername>.BlockList 82:0'
    - '@ADDLIST @<playername>.BlockList 87:0'
    - '@ADDLIST @<playername>.BlockList 88:0'
    - '@ADDLIST @<playername>.BlockList 129:0'
    - '@ADDLIST @<playername>.BlockList 153:0'
    - '@ADDLIST @<playername>.BlockList 137:0'
    - '@ADDLIST @<playername>.BlockList 137:1'
    - '@ADDLIST @<playername>.BlockList 174:0'
# Cube loop
    - '@LOOP 10'
    - ' @CALL Shared:DBCubeLoop'
    - '@ENDLOOP'
# smooth remaining terrain
#    - '@CMDOP /pos1'
#    - '@CMDOP /pos2'
#    - '@CMDOP /outset 10'
#    - '@CMDOP /smooth'
# msg to team
    - '@SETINT $<playername>.PlayersListCountTmp 0'
    # Send message to every player on a team.
    - '@LOOP @HardWorld.<var:$<playername>.SMTeam>PlayersList'
    - ' @SETSTR $<playername>.PlayersListStr @HardWorld.<var:$<playername>.SMTeam>PlayersList[<var:$<playername>.PlayersListCountTmp>]'
    - ' @CMDCON msg $<playername>.PlayersListStr <playername> has completed deconstructing $<worldname>.<playername>BuildingSchematic'
    - ' @CMDCON title $<playername>.PlayersListStr title {text:"Deconstruction Complete",color:red}'
    - ' @CMDCON title $<playername>.PlayersListStr subtitle {text:"<playername> has broken <var:$<worldname>.<playername>BuildingSchematic into pieces",color:yellow}'
    - ' @ADDINT $<playername>.PlayersListCountTmp 1'
    - '@ENDLOOP'
# remove variables
    - '@CMDCON npc remove <var:$<playername>.DemoBuilderID>'
    - '@DELVAR i $<playername>.PLocX'
    - '@DELVAR i $<playername>.PLocY'
    - '@DELVAR i $<playername>.PLocZ'
    - '@DELVAR i $<playername>.SiteOriginX'
    - '@DELVAR i $<playername>.SiteOriginY'
    - '@DELVAR i $<playername>.SiteOriginZ'
    - '@DELVAR i $<playername>.SiteMidX'
    - '@DELVAR i $<playername>.SiteMidY'
    - '@DELVAR i $<playername>.SiteMidZ'
    - '@DELVAR i $<playername>.SiteEndX'
    - '@DELVAR i $<playername>.SiteEndY'
    - '@DELVAR i $<playername>.SiteEndZ'
    - '@DELVAR i $<playername>.X1Adj'
    - '@DELVAR i $<playername>.Y1Adj'
    - '@DELVAR i $<playername>.Z1Adj'
    - '@DELVAR i $<playername>.X2Adj'
    - '@DELVAR i $<playername>.Y2Adj'
    - '@DELVAR i $<playername>.Z2Adj'
    - '@DELVAR s $<playername>.BlockTMP'
    - '@DELLIST @<playername>.BlockList'
    - '@DELVAR s $<playername>.BlockListStr'
    - '@DELLIST @<playername>.BarracksList'
    - '@DELVAR s $<playername>.SiteMidLocation'
    - '@DELVAR b $<playername>.BarracksListCheck'
    - '@DELVAR s $<playername>.SchemListStr'
    - '@DELVAR b $<playername>.BlockListCheck'
    - '@DELVAR i $<playername>.ListCount'
    - '@DELVAR i $<playername>.PlayersListCountTmp'
    - '@DELVAR s $<playername>.PlayersListStr'
    - '@DELVAR s $<worldname>.<playername>BuildingSchematic'
    - '@DELVAR i $<playername>.BuilderY'
    - '@DELVAR b $<playername>.BuilderSet'
#    - '@DELVAR i $<playername>.Randomizer'
    - '@DELVAR b $<playername>.DemoRunning'
  DBCubeLoop:
    Script:
    - '@BROADCAST &8LOG WHILE $<playername>.SiteEndY <= $<playername>.SiteMidY'
    - '@WHILE i $<playername>.SiteEndY <= $<playername>.SiteMidY'
    - '@SETSTR $<playername>.SiteMidLocation <var:$<playername>.SiteMidX>,'
    - '@ADDSTR $<playername>.SiteMidLocation <var:$<playername>.SiteMidY>,'
    - '@ADDSTR $<playername>.SiteMidLocation $<playername>.SiteMidZ'
    - '@GETBLOCK $<playername>.BlockTMP $<playername>.SiteMidLocation'
    - '@SETINT $<playername>.ListCount 0'
    - '@LOOP @<playername>.BlockList'
    - '  @SETSTR $<playername>.BlockListStr @<playername>.BlockList[<var:$<playername>.ListCount>]'
    - '  @IF s $<playername>.BlockListStr = $<playername>.BlockTMP'
    - '    @SETBOOL $<playername>.BlockListCheck true'
    - '    @BREAKLOOP'
    - '  @ENDIF'
    - '  @ADDINT $<playername>.ListCount 1'
    - '@ENDLOOP'
    - '@IF b $<playername>.BlockListCheck = true'
    - '  @SETBOOL $<playername>.BlockListCheck false'
    - '@ELSE'
    - '  @SETINT $<playername>.BuilderY $<playername>.SiteMidY'
    - '  @ADDINT $<playername>.BuilderY 1'
    - '  @CMDCON npc select <var:$<playername>.DemoBuilderID>' 
    - '  @CMDCON npc moveto --x $<playername>.SiteMidX --y $<playername>.BuilderY --z $<playername>.SiteMidZ --world <worldname>'
    - '  @IF b $<playername>.BuilderSet != true'
    - '    @SETBOOL $<playername>.BuilderSet true'
    - '    @PAUSE 5'
    - '  @ELSE'
    - '    @PAUSE 0.5'
    - '  @ENDIF'
    - '  @CMDOP setblock $<playername>.SiteMidX $<playername>.SiteMidY $<playername>.SiteMidZ minecraft:air 0 destroy'
    - '@ENDIF'
# advance cube
    - '@SUBINT $<playername>.SiteMidX 1'
    - '@IF i $<playername>.SiteMidX < $<playername>.SiteEndX'
    - '  @SETINT $<playername>.SiteMidX $<playername>.SiteOriginX'
    - '  @SUBINT $<playername>.SiteMidZ 1'
    - '@ENDIF'
    - '@IF i $<playername>.SiteMidZ < $<playername>.SiteEndZ'
    - '  @SETINT $<playername>.SiteMidZ $<playername>.SiteOriginZ'
    - '  @SUBINT $<playername>.SiteMidY 1'
    - '@ENDIF'
    - '@ENDWHILE'
  WoodConversion:
    Script:
    - '@IF s <inventorytitle> ?= WoodConversion'
    - ' @SWITCH i <clickedslot>'
    - '   @CASE 0'
#    - '     @CALL Menu:MenuHelp'
    - '   @PLAYER Help not setup'
    - '   @CASE 9'
    - '     @IF b <takeitem:<playername>:$ITEMID.SpruceWood:1> = True'
    - '       @PLAYER Converted 1 Spruce Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 1'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.BirchWood:1> = True'
    - '       @PLAYER Converted 1 Birch Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 1'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.JungleWood:1> = True'
    - '       @PLAYER Converted 1 Jungle Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 1'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.AcaciaWood:1> = True'
    - '       @PLAYER Converted 1 Acacia Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 1'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.DarkOakWood:1> = True'
    - '       @PLAYER Converted 1 Dark Oak Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 other type of wood to convert to 1 Oak Wood'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '   @CASE 18'
    - '     @IF b <takeitem:<playername>:$ITEMID.SpruceWood:5> = True'
    - '       @PLAYER Converted 5 Spruce Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 5'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.BirchWood:5> = True'
    - '       @PLAYER Converted 5 Birch Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 5'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.JungleWood:5> = True'
    - '       @PLAYER Converted 5 Jungle Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 5'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.AcaciaWood:5> = True'
    - '       @PLAYER Converted 5 Acacia Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 5'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.DarkOakWood:5> = True'
    - '       @PLAYER Converted 5 Dark Oak Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 other type of wood to convert to 5 Oak Wood'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '   @CASE 27'
    - '     @IF b <takeitem:<playername>:$ITEMID.SpruceWood:10> = True'
    - '       @PLAYER Converted 10 Spruce Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 10'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.BirchWood:10> = True'
    - '       @PLAYER Converted 10 Birch Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 10'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.JungleWood:10> = True'
    - '       @PLAYER Converted 10 Jungle Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 10'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.AcaciaWood:10> = True'
    - '       @PLAYER Converted 10 Acacia Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 10'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.DarkOakWood:10> = True'
    - '       @PLAYER Converted 10 Dark Oak Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 other type of wood to convert to 10 Oak Wood'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '   @CASE 36'
    - '     @IF b <takeitem:<playername>:$ITEMID.SpruceWood:64> = True'
    - '       @PLAYER Converted 64 Spruce Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 64'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.BirchWood:64> = True'
    - '       @PLAYER Converted 64 Birch Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 64'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.JungleWood:64> = True'
    - '       @PLAYER Converted 64 Jungle Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 64'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.AcaciaWood:64> = True'
    - '       @PLAYER Converted 64 Acacia Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 64'
    - '     @ELSE'
    - '     @IF b <takeitem:<playername>:$ITEMID.DarkOakWood:64> = True'
    - '       @PLAYER Converted 64 Dark Oak Wood to Oak Wood'
    - '       @CMDCON give <playername> OakWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 other type of wood to convert to 64 Oak Wood'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '     @ENDIF'
    - '   @CASE 1'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:1> = True'
    - '       @PLAYER Converted 1 Log'
    - '       @CMDCON give <playername> SpruceWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 Oak Wood to convert to 1 Spruce Wood'
    - '     @ENDIF'
    - '   @CASE 2'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:5> = True'
    - '       @PLAYER Converted 5 Logs'
    - '       @CMDCON give <playername> SpruceWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 Oak Wood to convert to 5 Spruce Wood'
    - '     @ENDIF'
    - '   @CASE 3'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:10> = True'
    - '       @PLAYER Converted 10 Logs'
    - '       @CMDCON give <playername> SpruceWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 Oak Wood to convert to 10 Spruce Wood'
    - '     @ENDIF'
    - '   @CASE 4'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:64> = True'
    - '       @PLAYER Converted 64 Logs'
    - '       @CMDCON give <playername> SpruceWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 Oak Wood to convert to 64 Spruce Wood'
    - '     @ENDIF'
    - '   @CASE 5'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:1> = True'
    - '       @PLAYER Converted 1 Log'
    - '       @CMDCON give <playername> BirchWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 Oak Wood to convert to 1 Birch Wood'
    - '     @ENDIF'
    - '   @CASE 6'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:5> = True'
    - '       @PLAYER Converted 5 Logs'
    - '       @CMDCON give <playername> BirchWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 Oak Wood to convert to 5 Birch Wood'
    - '     @ENDIF'
    - '   @CASE 7'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:10> = True'
    - '       @PLAYER Converted 10 Logs'
    - '       @CMDCON give <playername> BirchWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 Oak Wood to convert to 10 Birch Wood'
    - '     @ENDIF'
    - '   @CASE 8'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:64> = True'
    - '       @PLAYER Converted 64 Logs'
    - '       @CMDCON give <playername> BirchWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 Oak Wood to convert to 64 Birch Wood'
    - '     @ENDIF'
    - '   @CASE 10'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:1> = True'
    - '       @PLAYER Converted 1 Log'
    - '       @CMDCON give <playername> JungleWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 Oak Wood to convert to 1 Jungle Wood'
    - '     @ENDIF'
    - '   @CASE 11'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:5> = True'
    - '       @PLAYER Converted 5 Logs'
    - '       @CMDCON give <playername> JungleWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 Oak Wood to convert to 5 Jungle Wood'
    - '     @ENDIF'
    - '   @CASE 12'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:10> = True'
    - '       @PLAYER Converted 10 Logs'
    - '       @CMDCON give <playername> JungleWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 Oak Wood to convert to 10 Jungle Wood'
    - '     @ENDIF'
    - '   @CASE 13'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:64> = True'
    - '       @PLAYER Converted 64 Logs'
    - '       @CMDCON give <playername> JungleWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 Oak Wood to convert to 64 Jungle Wood'
    - '     @ENDIF'
    - '   @CASE 14'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:1> = True'
    - '       @PLAYER Converted 1 Log'
    - '       @CMDCON give <playername> AcaciaWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 Oak Wood to convert to 1 Acacia Wood'
    - '     @ENDIF'
    - '   @CASE 15'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:5> = True'
    - '       @PLAYER Converted 5 Logs'
    - '       @CMDCON give <playername> AcaciaWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 Oak Wood to convert to 5 Acacia Wood'
    - '     @ENDIF'
    - '   @CASE 16'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:10> = True'
    - '       @PLAYER Converted 10 Logs'
    - '       @CMDCON give <playername> AcaciaWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 Oak Wood to convert to 10 Acacia Wood'
    - '     @ENDIF'
    - '   @CASE 17'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:64> = True'
    - '       @PLAYER Converted 64 Logs'
    - '       @CMDCON give <playername> AcaciaWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 Oak Wood to convert to 64 Acacia Wood'
    - '     @ENDIF'
    - '   @CASE 19'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:1> = True'
    - '       @PLAYER Converted 1 Log'
    - '       @CMDCON give <playername> DarkOakWood 1'
    - '     @ELSE'
    - '       @PLAYER You need at least 1 Oak Wood to convert to 1 Dark Oak Wood'
    - '     @ENDIF'
    - '   @CASE 20'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:5> = True'
    - '       @PLAYER Converted 5 Logs'
    - '       @CMDCON give <playername> DarkOakWood 5'
    - '     @ELSE'
    - '       @PLAYER You need at least 5 Oak Wood to convert to 5 Dark Oak Wood'
    - '     @ENDIF'
    - '   @CASE 21'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:10> = True'
    - '       @PLAYER Converted 10 Logs'
    - '       @CMDCON give <playername> DarkOakWood 10'
    - '     @ELSE'
    - '       @PLAYER You need at least 10 Oak Wood to convert to 10 Dark Oak Wood'
    - '     @ENDIF'
    - '   @CASE 22'
    - '     @IF b <takeitem:<playername>:$ITEMID.OakWood:64> = True'
    - '       @PLAYER Converted 64 Logs'
    - '       @CMDCON give <playername> DarkOakWood 64'
    - '     @ELSE'
    - '       @PLAYER You need at least 64 Oak Wood to convert to 64 Dark Oak Wood'
    - '     @ENDIF'
    - ' @ENDSWITCH'
    - '@ENDIF'